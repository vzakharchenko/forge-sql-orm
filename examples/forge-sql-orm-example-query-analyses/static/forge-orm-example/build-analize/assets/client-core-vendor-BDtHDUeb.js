var nt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function En(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function wn(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var y=e.default;if(typeof y=="function"){var l=function v(){return this instanceof v?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};l.prototype=y.prototype}else l={};return Object.defineProperty(l,"__esModule",{value:!0}),Object.keys(e).forEach(function(v){var d=Object.getOwnPropertyDescriptor(e,v);Object.defineProperty(l,v,d.get?d:{enumerable:!0,get:function(){return e[v]}})}),l}var W={},Oe={},Te={},rt;function L(){return rt||(rt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Log=e.LogLevel=void 0;const y=" DEBUG ",l="  INFO ",v="  WARN ",d=" ERROR ";function g(f){return f.unshift("[Statsig]"),f}e.LogLevel={None:0,Error:1,Warn:2,Info:3,Debug:4};class m{static info(...h){m.level>=e.LogLevel.Info&&console.info(l,...g(h))}static debug(...h){m.level>=e.LogLevel.Debug&&console.debug(y,...g(h))}static warn(...h){m.level>=e.LogLevel.Warn&&console.warn(v,...g(h))}static error(...h){m.level>=e.LogLevel.Error&&console.error(d,...g(h))}}e.Log=m,m.level=e.LogLevel.Warn}(Te)),Te}var it;function le(){return it||(it=1,function(e){var y,l,v;Object.defineProperty(e,"__esModule",{value:!0}),e._getInstance=e._getStatsigGlobalFlag=e._getStatsigGlobal=void 0;const d=L(),g=()=>__STATSIG__||t;e._getStatsigGlobal=g;const m=n=>(0,e._getStatsigGlobal)()[n];e._getStatsigGlobalFlag=m;const f=n=>{const r=(0,e._getStatsigGlobal)();return n?r.instances&&r.instances[n]:(r.instances&&Object.keys(r.instances).length>1&&d.Log.warn("Call made to Statsig global instance without an SDK key but there is more than one client instance. If you are using mulitple clients, please specify the SDK key."),r.firstInstance)};e._getInstance=f;const h="__STATSIG__",u=typeof window<"u"?window:{},a=typeof nt<"u"?nt:{},i=typeof globalThis<"u"?globalThis:{},t=(v=(l=(y=u[h])!==null&&y!==void 0?y:a[h])!==null&&l!==void 0?l:i[h])!==null&&v!==void 0?v:{instance:e._getInstance};u[h]=t,a[h]=t,i[h]=t}(Oe)),Oe}var Ce={},ot;function We(){return ot||(ot=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Diagnostics=void 0;const y=new Map,l="start",v="end",d="statsig::diagnostics";e.Diagnostics={_getMarkers:u=>y.get(u),_markInitOverallStart:u=>{f(u,g({},l,"overall"))},_markInitOverallEnd:(u,a,i)=>{f(u,g({success:a,error:a?void 0:{name:"InitializeError",message:"Failed to initialize"},evaluationDetails:i},v,"overall"))},_markInitNetworkReqStart:(u,a)=>{f(u,g(a,l,"initialize","network_request"))},_markInitNetworkReqEnd:(u,a)=>{f(u,g(a,v,"initialize","network_request"))},_markInitProcessStart:u=>{f(u,g({},l,"initialize","process"))},_markInitProcessEnd:(u,a)=>{f(u,g(a,v,"initialize","process"))},_clearMarkers:u=>{y.delete(u)},_formatError(u){if(u&&typeof u=="object")return{code:h(u,"code"),name:h(u,"name"),message:h(u,"message")}},_getDiagnosticsData(u,a,i,t){var n;return{success:(u==null?void 0:u.ok)===!0,statusCode:u==null?void 0:u.status,sdkRegion:(n=u==null?void 0:u.headers)===null||n===void 0?void 0:n.get("x-statsig-region"),isDelta:i.includes('"is_delta":true')===!0?!0:void 0,attempt:a,error:e.Diagnostics._formatError(t)}},_enqueueDiagnosticsEvent(u,a,i,t){const n=e.Diagnostics._getMarkers(i);if(n==null||n.length<=0)return-1;const r=n[n.length-1].timestamp-n[0].timestamp;e.Diagnostics._clearMarkers(i);const o=m(u,{context:"initialize",markers:n.slice(),statsigOptions:t});return a.enqueue(o),r}};function g(u,a,i,t){return Object.assign({key:i,action:a,step:t,timestamp:Date.now()},u)}function m(u,a){return{eventName:d,user:u,value:null,metadata:a,time:Date.now()}}function f(u,a){var i;const t=(i=y.get(u))!==null&&i!==void 0?i:[];t.push(a),y.set(u,t)}function h(u,a){if(a in u)return u[a]}}(Ce)),Ce}var x={},H={},Re={},Q={},st;function xe(){if(st)return Q;st=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q._isTypeMatch=Q._typeOf=void 0;function e(l){return Array.isArray(l)?"array":typeof l}Q._typeOf=e;function y(l,v){const d=g=>Array.isArray(g)?"array":typeof g;return d(l)===d(v)}return Q._isTypeMatch=y,Q}var at;function be(){return at||(at=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._getSortedObject=e._DJB2Object=e._DJB2=void 0;const y=xe(),l=g=>{let m=0;for(let f=0;f<g.length;f++){const h=g.charCodeAt(f);m=(m<<5)-m+h,m=m&m}return String(m>>>0)};e._DJB2=l;const v=(g,m)=>(0,e._DJB2)(JSON.stringify((0,e._getSortedObject)(g,m)));e._DJB2Object=v;const d=(g,m)=>{if(g==null)return null;const f=Object.keys(g).sort(),h={};return f.forEach(u=>{const a=g[u];if(m===0||(0,y._typeOf)(a)!=="object"){h[u]=a;return}h[u]=(0,e._getSortedObject)(a,m!=null?m-1:m)}),h};e._getSortedObject=d}(Re)),Re}var lt;function De(){if(lt)return H;lt=1,Object.defineProperty(H,"__esModule",{value:!0}),H._getStorageKey=H._getUserStorageKey=void 0;const e=be();function y(v,d,g){var m;if(g)return g(v,d);const f=d&&d.customIDs?d.customIDs:{},h=[`uid:${(m=d==null?void 0:d.userID)!==null&&m!==void 0?m:""}`,`cids:${Object.keys(f).sort((u,a)=>u.localeCompare(a)).map(u=>`${u}-${f[u]}`).join(",")}`,`k:${v}`];return(0,e._DJB2)(h.join("|"))}H._getUserStorageKey=y;function l(v,d,g){return d?y(v,d,g):(0,e._DJB2)(`k:${v}`)}return H._getStorageKey=l,H}var Ue={},ut;function Ie(){return ut||(ut=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NetworkParam=e.NetworkDefault=e.Endpoint=void 0,e.Endpoint={_initialize:"initialize",_rgstr:"rgstr",_download_config_specs:"download_config_specs"},e.NetworkDefault={[e.Endpoint._rgstr]:"https://prodregistryv2.org/v1",[e.Endpoint._initialize]:"https://featureassets.org/v1",[e.Endpoint._download_config_specs]:"https://api.statsigcdn.com/v1"},e.NetworkParam={EventCount:"ec",SdkKey:"k",SdkType:"st",SdkVersion:"sv",Time:"t",SessionID:"sid",StatsigEncoded:"se",IsGzipped:"gz"}}(Ue)),Ue}var Me={},ct;function ue(){return ct||(ct=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._getCurrentPageUrlSafe=e._addDocumentEventListenerSafe=e._addWindowEventListenerSafe=e._isServerEnv=e._getDocumentSafe=e._getWindowSafe=void 0;const y=()=>typeof window<"u"?window:null;e._getWindowSafe=y;const l=()=>{var f;const h=(0,e._getWindowSafe)();return(f=h==null?void 0:h.document)!==null&&f!==void 0?f:null};e._getDocumentSafe=l;const v=()=>{if((0,e._getDocumentSafe)()!==null)return!1;const f=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;return typeof EdgeRuntime=="string"||f};e._isServerEnv=v;const d=(f,h)=>{const u=(0,e._getWindowSafe)();typeof(u==null?void 0:u.addEventListener)=="function"&&u.addEventListener(f,h)};e._addWindowEventListenerSafe=d;const g=(f,h)=>{const u=(0,e._getDocumentSafe)();typeof(u==null?void 0:u.addEventListener)=="function"&&u.addEventListener(f,h)};e._addDocumentEventListenerSafe=g;const m=()=>{var f;try{return(f=(0,e._getWindowSafe)())===null||f===void 0?void 0:f.location.href.split(/[?#]/)[0]}catch{return}};e._getCurrentPageUrlSafe=m}(Me)),Me}var A={},dt;function Jt(){if(dt)return A;dt=1,Object.defineProperty(A,"__esModule",{value:!0}),A._createLayerParameterExposure=A._createConfigExposure=A._mapExposures=A._createGateExposure=A._isExposureEvent=void 0;const e="statsig::config_exposure",y="statsig::gate_exposure",l="statsig::layer_exposure",v=(a,i,t,n,r)=>(t.bootstrapMetadata&&(n.bootstrapMetadata=t.bootstrapMetadata),{eventName:a,user:i,value:null,metadata:u(t,n),secondaryExposures:r,time:Date.now()}),d=({eventName:a})=>a===y||a===e||a===l;A._isExposureEvent=d;const g=(a,i,t)=>{var n,r,o;const s={gate:i.name,gateValue:String(i.value),ruleID:i.ruleID};return((n=i.__evaluation)===null||n===void 0?void 0:n.version)!=null&&(s.configVersion=i.__evaluation.version),v(y,a,i.details,s,m((o=(r=i.__evaluation)===null||r===void 0?void 0:r.secondary_exposures)!==null&&o!==void 0?o:[],t))};A._createGateExposure=g;function m(a,i){return a.map(t=>typeof t=="string"?(i??{})[t]:t).filter(t=>t!=null)}A._mapExposures=m;const f=(a,i,t)=>{var n,r,o,s;const c={config:i.name,ruleID:i.ruleID};return((n=i.__evaluation)===null||n===void 0?void 0:n.version)!=null&&(c.configVersion=i.__evaluation.version),((r=i.__evaluation)===null||r===void 0?void 0:r.passed)!=null&&(c.rulePassed=String(i.__evaluation.passed)),v(e,a,i.details,c,m((s=(o=i.__evaluation)===null||o===void 0?void 0:o.secondary_exposures)!==null&&s!==void 0?s:[],t))};A._createConfigExposure=f;const h=(a,i,t,n)=>{var r,o,s,c;const p=i.__evaluation,w=((r=p==null?void 0:p.explicit_parameters)===null||r===void 0?void 0:r.includes(t))===!0;let _="",S=(o=p==null?void 0:p.undelegated_secondary_exposures)!==null&&o!==void 0?o:[];w&&(_=(s=p.allocated_experiment_name)!==null&&s!==void 0?s:"",S=p.secondary_exposures);const E={config:i.name,parameterName:t,ruleID:i.ruleID,allocatedExperiment:_,isExplicitParameter:String(w)};return((c=i.__evaluation)===null||c===void 0?void 0:c.version)!=null&&(E.configVersion=i.__evaluation.version),v(l,a,i.details,E,m(S,n))};A._createLayerParameterExposure=h;const u=(a,i)=>(i.reason=a.reason,a.lcut&&(i.lcut=String(a.lcut)),a.receivedAt&&(i.receivedAt=String(a.receivedAt)),i);return A}var Pe={},_t;function z(){return _t||(_t=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._setObjectInStorage=e._getObjectFromStorage=e.Storage=void 0;const y=L(),l=ue(),v={},d={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"InMemory",getItem:i=>v[i]?v[i]:null,setItem:(i,t)=>{v[i]=t},removeItem:i=>{delete v[i]},getAllKeys:()=>Object.keys(v)};let g=null;try{const i=(0,l._getWindowSafe)();i&&i.localStorage&&typeof i.localStorage.getItem=="function"&&(g={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"LocalStorage",getItem:t=>i.localStorage.getItem(t),setItem:(t,n)=>i.localStorage.setItem(t,n),removeItem:t=>i.localStorage.removeItem(t),getAllKeys:()=>Object.keys(i.localStorage)})}catch{y.Log.warn("Failed to setup localStorageProvider.")}let m=g??d,f=m;function h(i){try{return i()}catch(t){if(t instanceof Error&&t.name==="SecurityError")return e.Storage._setProvider(d),null;throw t}}e.Storage={isReady:()=>f.isReady(),isReadyResolver:()=>f.isReadyResolver(),getProviderName:()=>f.getProviderName(),getItem:i=>h(()=>f.getItem(i)),setItem:(i,t)=>f.setItem(i,t),removeItem:i=>f.removeItem(i),getAllKeys:()=>f.getAllKeys(),_setProvider:i=>{m=i,f=i},_setDisabled:i=>{i?f=d:f=m}};function u(i){const t=e.Storage.getItem(i);return JSON.parse(t??"null")}e._getObjectFromStorage=u;function a(i,t){e.Storage.setItem(i,JSON.stringify(t))}e._setObjectInStorage=a}(Pe)),Pe}var _e={},ft;function Wt(){if(ft)return _e;ft=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.UrlConfiguration=void 0;const e=Ie(),y={[e.Endpoint._initialize]:"i",[e.Endpoint._rgstr]:"e",[e.Endpoint._download_config_specs]:"d"};let l=class{constructor(d,g,m,f){this.customUrl=null,this.fallbackUrls=null,this.endpoint=d,this.endpointDnsKey=y[d],g&&(this.customUrl=g),!g&&m&&(this.customUrl=m.endsWith("/")?`${m}${d}`:`${m}/${d}`),f&&(this.fallbackUrls=f);const h=e.NetworkDefault[d];this.defaultUrl=`${h}/${d}`}getUrl(){var d;return(d=this.customUrl)!==null&&d!==void 0?d:this.defaultUrl}};return _e.UrlConfiguration=l,_e}var Le={},gt;function He(){return gt||(gt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._notifyVisibilityChanged=e._subscribeToVisiblityChanged=e._isUnloading=e._isCurrentlyVisible=void 0;const y=ue(),l="foreground",v="background",d=[];let g=l,m=!1;const f=()=>g===l;e._isCurrentlyVisible=f;const h=()=>m;e._isUnloading=h;const u=i=>{d.unshift(i)};e._subscribeToVisiblityChanged=u;const a=i=>{i!==g&&(g=i,d.forEach(t=>t(i)))};e._notifyVisibilityChanged=a,(0,y._addWindowEventListenerSafe)("focus",()=>{m=!1,(0,e._notifyVisibilityChanged)(l)}),(0,y._addWindowEventListenerSafe)("blur",()=>(0,e._notifyVisibilityChanged)(v)),(0,y._addWindowEventListenerSafe)("beforeunload",()=>{m=!0,(0,e._notifyVisibilityChanged)(v)}),(0,y._addDocumentEventListenerSafe)("visibilitychange",()=>{(0,e._notifyVisibilityChanged)(document.visibilityState==="visible"?l:v)})}(Le)),Le}var vt;function xt(){if(vt)return x;vt=1;var e=x&&x.__awaiter||function(w,_,S,E){function D(C){return C instanceof S?C:new S(function(R){R(C)})}return new(S||(S=Promise))(function(C,R){function B(k){try{J(E.next(k))}catch(b){R(b)}}function re(k){try{J(E.throw(k))}catch(b){R(b)}}function J(k){k.done?C(k.value):D(k.value).then(B,re)}J((E=E.apply(w,_||[])).next())})};Object.defineProperty(x,"__esModule",{value:!0}),x.EventLogger=void 0;const y=De(),l=be(),v=L(),d=Ie(),g=ue(),m=Jt(),f=z(),h=Wt(),u=He(),a=100,i=1e4,t=1e3,n=6e5,r=500,o=200,s={},c={Startup:"startup",GainedFocus:"gained_focus"};let p=class ae{static _safeFlushAndForget(_){var S;(S=s[_])===null||S===void 0||S.flush().catch(()=>{})}static _safeRetryFailedLogs(_){var S;(S=s[_])===null||S===void 0||S._retryFailedLogs(c.GainedFocus)}constructor(_,S,E,D){var C;this._sdkKey=_,this._emitter=S,this._network=E,this._options=D,this._queue=[],this._lastExposureTimeMap={},this._nonExposedChecks={},this._hasRunQuickFlush=!1,this._creationTime=Date.now(),this._isLoggingDisabled=(D==null?void 0:D.disableLogging)===!0,this._maxQueueSize=(C=D==null?void 0:D.loggingBufferMaxSize)!==null&&C!==void 0?C:a;const R=D==null?void 0:D.networkConfig;this._logEventUrlConfig=new h.UrlConfiguration(d.Endpoint._rgstr,R==null?void 0:R.logEventUrl,R==null?void 0:R.api,R==null?void 0:R.logEventFallbackUrls)}setLoggingDisabled(_){this._isLoggingDisabled=_}enqueue(_){this._shouldLogEvent(_)&&(this._normalizeAndAppendEvent(_),this._quickFlushIfNeeded(),this._queue.length>this._maxQueueSize&&ae._safeFlushAndForget(this._sdkKey))}incrementNonExposureCount(_){var S;const E=(S=this._nonExposedChecks[_])!==null&&S!==void 0?S:0;this._nonExposedChecks[_]=E+1}reset(){this._lastExposureTimeMap={}}start(){(0,g._isServerEnv)()||(s[this._sdkKey]=this,(0,u._subscribeToVisiblityChanged)(_=>{_==="background"?ae._safeFlushAndForget(this._sdkKey):_==="foreground"&&ae._safeRetryFailedLogs(this._sdkKey)}),this._retryFailedLogs(c.Startup),this._startBackgroundFlushInterval())}stop(){return e(this,void 0,void 0,function*(){this._flushIntervalId&&(clearInterval(this._flushIntervalId),this._flushIntervalId=null),delete s[this._sdkKey],yield this.flush()})}flush(){return e(this,void 0,void 0,function*(){if(this._appendAndResetNonExposedChecks(),this._queue.length===0)return;const _=this._queue;this._queue=[],yield this._sendEvents(_)})}_quickFlushIfNeeded(){this._hasRunQuickFlush||(this._hasRunQuickFlush=!0,!(Date.now()-this._creationTime>o)&&setTimeout(()=>ae._safeFlushAndForget(this._sdkKey),o))}_shouldLogEvent(_){if((0,g._isServerEnv)())return!1;if(!(0,m._isExposureEvent)(_))return!0;const S=_.user?_.user:{statsigEnvironment:void 0},E=(0,y._getUserStorageKey)(this._sdkKey,S),D=_.metadata?_.metadata:{},C=[_.eventName,E,D.gate,D.config,D.ruleID,D.allocatedExperiment,D.parameterName,String(D.isExplicitParameter),D.reason].join("|"),R=this._lastExposureTimeMap[C],B=Date.now();return R&&B-R<n?!1:(Object.keys(this._lastExposureTimeMap).length>t&&(this._lastExposureTimeMap={}),this._lastExposureTimeMap[C]=B,!0)}_sendEvents(_){var S,E;return e(this,void 0,void 0,function*(){if(this._isLoggingDisabled)return this._saveFailedLogsToStorage(_),!1;try{const C=(0,u._isUnloading)()&&this._network.isBeaconSupported()&&((E=(S=this._options)===null||S===void 0?void 0:S.networkConfig)===null||E===void 0?void 0:E.networkOverrideFunc)==null;return this._emitter({name:"pre_logs_flushed",events:_}),(C?yield this._sendEventsViaBeacon(_):yield this._sendEventsViaPost(_)).success?(this._emitter({name:"logs_flushed",events:_}),!0):(v.Log.warn("Failed to flush events."),this._saveFailedLogsToStorage(_),!1)}catch{return v.Log.warn("Failed to flush events."),!1}})}_sendEventsViaPost(_){var S;return e(this,void 0,void 0,function*(){const E=yield this._network.post(this._getRequestData(_)),D=(S=E==null?void 0:E.code)!==null&&S!==void 0?S:-1;return{success:D>=200&&D<300}})}_sendEventsViaBeacon(_){return e(this,void 0,void 0,function*(){return{success:yield this._network.beacon(this._getRequestData(_))}})}_getRequestData(_){return{sdkKey:this._sdkKey,data:{events:_},urlConfig:this._logEventUrlConfig,retries:3,isCompressable:!0,params:{[d.NetworkParam.EventCount]:String(_.length)}}}_saveFailedLogsToStorage(_){for(;_.length>r;)_.shift();const S=this._getStorageKey();try{(0,f._setObjectInStorage)(S,_)}catch{v.Log.warn("Unable to save failed logs to storage")}}_retryFailedLogs(_){const S=this._getStorageKey();e(this,void 0,void 0,function*(){f.Storage.isReady()||(yield f.Storage.isReadyResolver());const E=(0,f._getObjectFromStorage)(S);if(!E)return;_===c.Startup&&f.Storage.removeItem(S),(yield this._sendEvents(E))&&_===c.GainedFocus&&f.Storage.removeItem(S)}).catch(()=>{v.Log.warn("Failed to flush stored logs")})}_getStorageKey(){return`statsig.failed_logs.${(0,l._DJB2)(this._sdkKey)}`}_normalizeAndAppendEvent(_){_.user&&(_.user=Object.assign({},_.user),delete _.user.privateAttributes);const S={},E=this._getCurrentPageUrl();E&&(S.statsigMetadata={currentPage:E});const D=Object.assign(Object.assign({},_),S);v.Log.debug("Enqueued Event:",D),this._queue.push(D)}_appendAndResetNonExposedChecks(){Object.keys(this._nonExposedChecks).length!==0&&(this._normalizeAndAppendEvent({eventName:"statsig::non_exposed_checks",user:null,time:Date.now(),metadata:{checks:Object.assign({},this._nonExposedChecks)}}),this._nonExposedChecks={})}_getCurrentPageUrl(){var _;if(((_=this._options)===null||_===void 0?void 0:_.includeCurrentPageUrlWithEvents)!==!1)return(0,g._getCurrentPageUrlSafe)()}_startBackgroundFlushInterval(){var _,S;const E=(S=(_=this._options)===null||_===void 0?void 0:_.loggingIntervalMs)!==null&&S!==void 0?S:i,D=setInterval(()=>{const C=s[this._sdkKey];!C||C._flushIntervalId!==D?clearInterval(D):ae._safeFlushAndForget(this._sdkKey)},E);this._flushIntervalId=D}};return x.EventLogger=p,x}var je={},ht;function we(){return ht||(ht=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StatsigMetadataProvider=e.SDK_VERSION=void 0,e.SDK_VERSION="3.12.2";let y={sdkVersion:e.SDK_VERSION,sdkType:"js-mono"};e.StatsigMetadataProvider={get:()=>y,add:l=>{y=Object.assign(Object.assign({},y),l)}}}(je)),je}var Ne={},yt;function nn(){return yt||(yt=1,Object.defineProperty(Ne,"__esModule",{value:!0})),Ne}var G={},fe={},ge={},St;function Qe(){if(St)return ge;St=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.getUUID=void 0;function e(){if(typeof crypto<"u"&&typeof crypto.randomUUID=="function")return crypto.randomUUID();let y=new Date().getTime(),l=typeof performance<"u"&&performance.now&&performance.now()*1e3||0;return`xxxxxxxx-xxxx-4xxx-${"89ab"[Math.floor(Math.random()*4)]}xxx-xxxxxxxxxxxx`.replace(/[xy]/g,d=>{let g=Math.random()*16;return y>0?(g=(y+g)%16|0,y=Math.floor(y/16)):(g=(l+g)%16|0,l=Math.floor(l/16)),(d==="x"?g:g&7|8).toString(16)})}return ge.getUUID=e,ge}var mt;function Xe(){if(mt)return fe;mt=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.StableID=void 0;const e=De(),y=L(),l=z(),v=Qe(),d={};fe.StableID={get:h=>{if(d[h]==null){let u=f(h);u==null&&(u=(0,v.getUUID)(),m(u,h)),d[h]=u}return d[h]},setOverride:(h,u)=>{d[u]=h,m(h,u)}};function g(h){return`statsig.stable_id.${(0,e._getStorageKey)(h)}`}function m(h,u){const a=g(u);try{(0,l._setObjectInStorage)(a,h)}catch{y.Log.warn("Failed to save StableID")}}function f(h){const u=g(h);return(0,l._getObjectFromStorage)(u)}return fe}var X={},pt;function Ht(){if(pt)return X;pt=1,Object.defineProperty(X,"__esModule",{value:!0}),X._getFullUserHash=X._normalizeUser=void 0;const e=be(),y=L();function l(d,g,m){try{const f=JSON.parse(JSON.stringify(d));return g!=null&&g.environment!=null?f.statsigEnvironment=g.environment:m!=null&&(f.statsigEnvironment={tier:m}),f}catch{return y.Log.error("Failed to JSON.stringify user"),{statsigEnvironment:void 0}}}X._normalizeUser=l;function v(d){return d?(0,e._DJB2Object)(d):null}return X._getFullUserHash=v,X}var ve={},bt;function Qt(){if(bt)return ve;bt=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve._typedJsonParse=void 0;const e=L();function y(l,v,d){try{const g=JSON.parse(l);if(g&&typeof g=="object"&&v in g)return g}catch{}return e.Log.error(`Failed to parse ${d}`),null}return ve._typedJsonParse=y,ve}var Et;function rn(){if(Et)return G;Et=1;var e=G&&G.__awaiter||function(i,t,n,r){function o(s){return s instanceof n?s:new n(function(c){c(s)})}return new(n||(n=Promise))(function(s,c){function p(S){try{_(r.next(S))}catch(E){c(E)}}function w(S){try{_(r.throw(S))}catch(E){c(E)}}function _(S){S.done?s(S.value):o(S.value).then(p,w)}_((r=r.apply(i,t||[])).next())})};Object.defineProperty(G,"__esModule",{value:!0}),G._makeDataAdapterResult=G.DataAdapterCore=void 0;const y=L(),l=Xe(),v=Ht(),d=z(),g=Qt(),m=10;let f=class{constructor(t,n){this._adapterName=t,this._cacheSuffix=n,this._options=null,this._sdkKey=null,this._lastModifiedStoreKey=`statsig.last_modified_time.${n}`,this._inMemoryCache=new u}attach(t,n){this._sdkKey=t,this._options=n}getDataSync(t){const n=t&&(0,v._normalizeUser)(t,this._options),r=this._getCacheKey(n),o=this._inMemoryCache.get(r,n);if(o)return o;const s=this._loadFromCache(r);return s?(this._inMemoryCache.add(r,s),this._inMemoryCache.get(r,n)):null}setData(t,n){const r=n&&(0,v._normalizeUser)(n,this._options),o=this._getCacheKey(r);this._inMemoryCache.add(o,h("Bootstrap",t,null,r))}_getDataAsyncImpl(t,n,r){return e(this,void 0,void 0,function*(){d.Storage.isReady()||(yield d.Storage.isReadyResolver());const o=t??this.getDataSync(n),s=[this._fetchAndPrepFromNetwork(o,n,r)];return r!=null&&r.timeoutMs&&s.push(new Promise(c=>setTimeout(c,r.timeoutMs)).then(()=>(y.Log.debug("Fetching latest value timed out"),null))),yield Promise.race(s)})}_prefetchDataImpl(t,n){return e(this,void 0,void 0,function*(){const r=t&&(0,v._normalizeUser)(t,this._options),o=this._getCacheKey(r),s=yield this._getDataAsyncImpl(null,r,n);s&&this._inMemoryCache.add(o,Object.assign(Object.assign({},s),{source:"Prefetch"}))})}_fetchAndPrepFromNetwork(t,n,r){var o;return e(this,void 0,void 0,function*(){const s=(o=t==null?void 0:t.data)!==null&&o!==void 0?o:null,c=t!=null&&this._isCachedResultValidFor204(t,n),p=yield this._fetchFromNetwork(s,n,r,c);if(!p)return y.Log.debug("No response returned for latest value"),null;const w=(0,g._typedJsonParse)(p,"has_updates","Response"),_=this._getSdkKey(),S=l.StableID.get(_);let E=null;if((w==null?void 0:w.has_updates)===!0)E=h("Network",p,S,n);else if(s&&(w==null?void 0:w.has_updates)===!1)E=h("NetworkNotModified",s,S,n);else return null;const D=this._getCacheKey(n);return this._inMemoryCache.add(D,E),this._writeToCache(D,E),E})}_getSdkKey(){return this._sdkKey!=null?this._sdkKey:(y.Log.error(`${this._adapterName} is not attached to a Client`),"")}_loadFromCache(t){var n;const r=(n=d.Storage.getItem)===null||n===void 0?void 0:n.call(d.Storage,t);if(r==null)return null;const o=(0,g._typedJsonParse)(r,"source","Cached Result");return o?Object.assign(Object.assign({},o),{source:"Cache"}):null}_writeToCache(t,n){d.Storage.setItem(t,JSON.stringify(n)),this._runLocalStorageCacheEviction(t)}_runLocalStorageCacheEviction(t){var n;const r=(n=(0,d._getObjectFromStorage)(this._lastModifiedStoreKey))!==null&&n!==void 0?n:{};r[t]=Date.now();const o=a(r,m);o&&(delete r[o],d.Storage.removeItem(o)),(0,d._setObjectInStorage)(this._lastModifiedStoreKey,r)}};G.DataAdapterCore=f;function h(i,t,n,r){return{source:i,data:t,receivedAt:Date.now(),stableID:n,fullUserHash:(0,v._getFullUserHash)(r)}}G._makeDataAdapterResult=h;class u{constructor(){this._data={}}get(t,n){var r;const o=this._data[t],s=o==null?void 0:o.stableID,c=(r=n==null?void 0:n.customIDs)===null||r===void 0?void 0:r.stableID;return c&&s&&c!==s?(y.Log.warn("'StatsigUser.customIDs.stableID' mismatch"),null):o}add(t,n){const r=a(this._data,m-1);r&&delete this._data[r],this._data[t]=n}merge(t){this._data=Object.assign(Object.assign({},this._data),t)}}function a(i,t){const n=Object.keys(i);return n.length<=t?null:n.reduce((r,o)=>{const s=i[r],c=i[o];return typeof s=="object"&&typeof c=="object"?c.receivedAt<s.receivedAt?o:r:c<s?o:r})}return G}var Ae={},wt;function on(){return wt||(wt=1,Object.defineProperty(Ae,"__esModule",{value:!0})),Ae}var he={},ye={},Dt;function Ye(){if(Dt)return ye;Dt=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.SDKType=void 0;const e={};let y;return ye.SDKType={_get:l=>{var v;return((v=e[l])!==null&&v!==void 0?v:"js-mono")+(y??"")},_setClientType(l,v){e[l]=v},_setBindingType(l){(!y||y==="-react")&&(y="-"+l)}},ye}var It;function Xt(){return It||(It=1,function(e){var y=he&&he.__awaiter||function(a,i,t,n){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function c(_){try{w(n.next(_))}catch(S){s(S)}}function p(_){try{w(n.throw(_))}catch(S){s(S)}}function w(_){_.done?o(_.value):r(_.value).then(c,p)}w((n=n.apply(a,i||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorBoundary=e.EXCEPTION_ENDPOINT=void 0;const l=L(),v=Ye(),d=we();e.EXCEPTION_ENDPOINT="https://statsigapi.net/v1/sdk_exception";const g="[Statsig] UnknownError";let m=class{constructor(i,t,n,r){this._sdkKey=i,this._options=t,this._emitter=n,this._lastSeenError=r,this._seen=new Set}wrap(i){try{const t=i;u(t).forEach(n=>{const r=t[n];"$EB"in r||(t[n]=(...o)=>this._capture(n,()=>r.apply(i,o)),t[n].$EB=!0)})}catch(t){this._onError("eb:wrap",t)}}logError(i,t){this._onError(i,t)}getLastSeenErrorAndReset(){const i=this._lastSeenError;return this._lastSeenError=void 0,i??null}attachErrorIfNoneExists(i){this._lastSeenError||(this._lastSeenError=f(i))}_capture(i,t){try{const n=t();return n&&n instanceof Promise?n.catch(r=>this._onError(i,r)):n}catch(n){return this._onError(i,n),null}}_onError(i,t){try{l.Log.warn(`Caught error in ${i}`,{error:t}),y(this,void 0,void 0,function*(){var r,o,s,c,p,w,_;const S=t||Error(g),E=S instanceof Error,D=E?S.name:"No Name",C=f(S);if(this._lastSeenError=C,this._seen.has(D))return;if(this._seen.add(D),!((o=(r=this._options)===null||r===void 0?void 0:r.networkConfig)===null||o===void 0)&&o.preventAllNetworkTraffic){(s=this._emitter)===null||s===void 0||s.call(this,{name:"error",error:t,tag:i});return}const R=v.SDKType._get(this._sdkKey),B=d.StatsigMetadataProvider.get(),re=E?S.stack:h(S),J=JSON.stringify(Object.assign({tag:i,exception:D,info:re},Object.assign(Object.assign({},B),{sdkType:R})));yield((w=(p=(c=this._options)===null||c===void 0?void 0:c.networkConfig)===null||p===void 0?void 0:p.networkOverrideFunc)!==null&&w!==void 0?w:fetch)(e.EXCEPTION_ENDPOINT,{method:"POST",headers:{"STATSIG-API-KEY":this._sdkKey,"STATSIG-SDK-TYPE":String(R),"STATSIG-SDK-VERSION":String(B.sdkVersion),"Content-Type":"application/json"},body:J}),(_=this._emitter)===null||_===void 0||_.call(this,{name:"error",error:t,tag:i})}).then(()=>{}).catch(()=>{})}catch{}}};e.ErrorBoundary=m;function f(a){return a instanceof Error?a:typeof a=="string"?new Error(a):new Error("An unknown error occurred.")}function h(a){try{return JSON.stringify(a)}catch{return g}}function u(a){const i=new Set;let t=Object.getPrototypeOf(a);for(;t&&t!==Object.prototype;)Object.getOwnPropertyNames(t).filter(n=>typeof(t==null?void 0:t[n])=="function").forEach(n=>i.add(n)),t=Object.getPrototypeOf(t);return Array.from(i)}}(he)),he}var Fe={},kt;function sn(){return kt||(kt=1,Object.defineProperty(Fe,"__esModule",{value:!0})),Fe}var qe={},Ot;function an(){return Ot||(Ot=1,Object.defineProperty(qe,"__esModule",{value:!0})),qe}var Ke={},Tt;function ln(){return Tt||(Tt=1,Object.defineProperty(Ke,"__esModule",{value:!0})),Ke}var Y={},Ct;function Yt(){if(Ct)return Y;Ct=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.createMemoKey=Y.MemoPrefix=void 0,Y.MemoPrefix={_gate:"g",_dynamicConfig:"c",_experiment:"e",_layer:"l",_paramStore:"p"};const e=new Set([]),y=new Set(["userPersistedValues"]);function l(v,d,g){let m=`${v}|${d}`;if(!g)return m;for(const f of Object.keys(g)){if(y.has(f))return;e.has(f)?m+=`|${f}=true`:m+=`|${f}=${g[f]}`}return m}return Y.createMemoKey=l,Y}var Z={},V={},ee={},Rt;function un(){if(Rt)return ee;Rt=1;var e=ee&&ee.__awaiter||function(f,h,u,a){function i(t){return t instanceof u?t:new u(function(n){n(t)})}return new(u||(u=Promise))(function(t,n){function r(c){try{s(a.next(c))}catch(p){n(p)}}function o(c){try{s(a.throw(c))}catch(p){n(p)}}function s(c){c.done?t(c.value):i(c.value).then(r,o)}s((a=a.apply(f,h||[])).next())})};Object.defineProperty(ee,"__esModule",{value:!0}),ee._fetchTxtRecords=void 0;const y=new Uint8Array([0,0,1,0,0,1,0,0,0,0,0,0,13,102,101,97,116,117,114,101,97,115,115,101,116,115,3,111,114,103,0,0,16,0,1]),l="https://cloudflare-dns.com/dns-query",v=["i","e","d"],d=200;function g(f){return e(this,void 0,void 0,function*(){const h=yield f(l,{method:"POST",headers:{"Content-Type":"application/dns-message",Accept:"application/dns-message"},body:y});if(!h.ok){const i=new Error("Failed to fetch TXT records from DNS");throw i.name="DnsTxtFetchError",i}const u=yield h.arrayBuffer(),a=new Uint8Array(u);return m(a)})}ee._fetchTxtRecords=g;function m(f){const h=f.findIndex((a,i)=>i<d&&String.fromCharCode(a)==="="&&v.includes(String.fromCharCode(f[i-1])));if(h===-1){const a=new Error("Failed to parse TXT records from DNS");throw a.name="DnsTxtParseError",a}let u="";for(let a=h-1;a<f.length;a++)u+=String.fromCharCode(f[a]);return u.split(",")}return ee}var Ut;function cn(){if(Ut)return V;Ut=1;var e=V&&V.__awaiter||function(n,r,o,s){function c(p){return p instanceof o?p:new o(function(w){w(p)})}return new(o||(o=Promise))(function(p,w){function _(D){try{E(s.next(D))}catch(C){w(C)}}function S(D){try{E(s.throw(D))}catch(C){w(C)}}function E(D){D.done?p(D.value):c(D.value).then(_,S)}E((s=s.apply(n,r||[])).next())})};Object.defineProperty(V,"__esModule",{value:!0}),V._isDomainFailure=V.NetworkFallbackResolver=void 0;const y=un(),l=be(),v=L(),d=z(),g=7*24*60*60*1e3,m=4*60*60*1e3;let f=class{constructor(r){var o;this._fallbackInfo=null,this._errorBoundary=null,this._dnsQueryCooldowns={},this._networkOverrideFunc=(o=r.networkConfig)===null||o===void 0?void 0:o.networkOverrideFunc}setErrorBoundary(r){this._errorBoundary=r}tryBumpExpiryTime(r,o){var s;const c=(s=this._fallbackInfo)===null||s===void 0?void 0:s[o.endpoint];c&&(c.expiryTime=Date.now()+g,a(r,Object.assign(Object.assign({},this._fallbackInfo),{[o.endpoint]:c})))}getActiveFallbackUrl(r,o){var s,c;let p=this._fallbackInfo;p==null&&(p=(s=i(r))!==null&&s!==void 0?s:{},this._fallbackInfo=p);const w=p[o.endpoint];return!w||Date.now()>((c=w.expiryTime)!==null&&c!==void 0?c:0)?(delete p[o.endpoint],this._fallbackInfo=p,a(r,this._fallbackInfo),null):w.url?w.url:null}getFallbackFromProvided(r){const o=t(r);return o?r.replace(o,""):null}tryFetchUpdatedFallbackInfo(r,o,s,c){var p,w;return e(this,void 0,void 0,function*(){try{if(!h(s,c))return!1;const S=o.customUrl==null&&o.fallbackUrls==null?yield this._tryFetchFallbackUrlsFromNetwork(o):o.fallbackUrls,E=this._pickNewFallbackUrl((p=this._fallbackInfo)===null||p===void 0?void 0:p[o.endpoint],S);return E?(this._updateFallbackInfoWithNewUrl(r,o.endpoint,E),!0):!1}catch(_){return(w=this._errorBoundary)===null||w===void 0||w.logError("tryFetchUpdatedFallbackInfo",_),!1}})}_updateFallbackInfoWithNewUrl(r,o,s){var c,p,w;const _={url:s,expiryTime:Date.now()+g,previous:[]},S=(c=this._fallbackInfo)===null||c===void 0?void 0:c[o];S&&_.previous.push(...S.previous),_.previous.length>10&&(_.previous=[]);const E=(w=(p=this._fallbackInfo)===null||p===void 0?void 0:p[o])===null||w===void 0?void 0:w.url;E!=null&&_.previous.push(E),this._fallbackInfo=Object.assign(Object.assign({},this._fallbackInfo),{[o]:_}),a(r,this._fallbackInfo)}_tryFetchFallbackUrlsFromNetwork(r){var o;return e(this,void 0,void 0,function*(){const s=this._dnsQueryCooldowns[r.endpoint];if(s&&Date.now()<s)return null;this._dnsQueryCooldowns[r.endpoint]=Date.now()+m;const c=[],p=yield(0,y._fetchTxtRecords)((o=this._networkOverrideFunc)!==null&&o!==void 0?o:fetch),w=t(r.defaultUrl);for(const _ of p){if(!_.startsWith(r.endpointDnsKey+"="))continue;const S=_.split("=");if(S.length>1){let E=S[1];E.endsWith("/")&&(E=E.slice(0,-1)),c.push(`https://${E}${w}`)}}return c})}_pickNewFallbackUrl(r,o){var s;if(o==null)return null;const c=new Set((s=r==null?void 0:r.previous)!==null&&s!==void 0?s:[]),p=r==null?void 0:r.url;let w=null;for(const _ of o){const S=_.endsWith("/")?_.slice(0,-1):_;if(!c.has(_)&&S!==p){w=S;break}}return w}};V.NetworkFallbackResolver=f;function h(n,r){var o;const s=(o=n==null?void 0:n.toLowerCase())!==null&&o!==void 0?o:"";return r||s.includes("uncaught exception")||s.includes("failed to fetch")||s.includes("networkerror when attempting to fetch resource")}V._isDomainFailure=h;function u(n){return`statsig.network_fallback.${(0,l._DJB2)(n)}`}function a(n,r){const o=u(n);if(!r||Object.keys(r).length===0){d.Storage.removeItem(o);return}d.Storage.setItem(o,JSON.stringify(r))}function i(n){const r=u(n),o=d.Storage.getItem(r);if(!o)return null;try{return JSON.parse(o)}catch{return v.Log.error("Failed to parse FallbackInfo"),null}}function t(n){try{return new URL(n).pathname}catch{return null}}return V}var Se={},Mt;function Zt(){if(Mt)return Se;Mt=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.SDKFlags=void 0;const e={};return Se.SDKFlags={setFlags:(y,l)=>{e[y]=l},get:(y,l)=>{var v,d;return(d=(v=e[y])===null||v===void 0?void 0:v[l])!==null&&d!==void 0?d:!1}},Se}var Be={},Pt;function Ze(){return Pt||(Pt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StatsigSession=e.SessionID=void 0;const y=De(),l=L(),v=z(),d=Qe(),g=30*60*1e3,m=4*60*60*1e3,f={};e.SessionID={get:c=>e.StatsigSession.get(c).data.sessionID},e.StatsigSession={get:c=>{f[c]==null&&(f[c]=h(c));const p=f[c];return a(p)},overrideInitialSessionID:(c,p)=>{f[p]=u(c,p)}};function h(c){let p=s(c);const w=Date.now();return p||(p={sessionID:(0,d.getUUID)(),startTime:w,lastUpdate:w}),{data:p,sdkKey:c}}function u(c,p){const w=Date.now();return{data:{sessionID:c,startTime:w,lastUpdate:w},sdkKey:p}}function a(c){const p=Date.now(),w=c.data;(t(w)||n(w))&&(w.sessionID=(0,d.getUUID)(),w.startTime=p),w.lastUpdate=p,o(w,c.sdkKey),clearTimeout(c.idleTimeoutID),clearTimeout(c.ageTimeoutID);const _=p-w.startTime,S=c.sdkKey;return c.idleTimeoutID=i(S,g),c.ageTimeoutID=i(S,m-_),c}function i(c,p){return setTimeout(()=>{const w=__STATSIG__==null?void 0:__STATSIG__.instance(c);w&&w.$emt({name:"session_expired"})},p)}function t({lastUpdate:c}){return Date.now()-c>g}function n({startTime:c}){return Date.now()-c>m}function r(c){return`statsig.session_id.${(0,y._getStorageKey)(c)}`}function o(c,p){const w=r(p);try{(0,v._setObjectInStorage)(w,c)}catch{l.Log.warn("Failed to save SessionID")}}function s(c){const p=r(c);return(0,v._getObjectFromStorage)(p)}}(Be)),Be}var me={},Lt;function en(){return Lt||(Lt=1,Object.defineProperty(me,"__esModule",{value:!0}),me.ErrorTag=void 0,me.ErrorTag={NetworkError:"NetworkError"}),me}var jt;function dn(){if(jt)return Z;jt=1;var e=Z&&Z.__awaiter||function(k,b,I,T){function O(U){return U instanceof I?U:new I(function(M){M(U)})}return new(I||(I=Promise))(function(U,M){function ce(j){try{q(T.next(j))}catch(N){M(N)}}function $(j){try{q(T.throw(j))}catch(N){M(N)}}function q(j){j.done?U(j.value):O(j.value).then(ce,$)}q((T=T.apply(k,b||[])).next())})};Object.defineProperty(Z,"__esModule",{value:!0}),Z.NetworkCore=void 0,le();const y=le(),l=We(),v=L(),d=Ie(),g=cn(),m=Zt(),f=Ye(),h=ue(),u=Ze(),a=Xe(),i=en(),t=we(),n=He(),r=1e4,o=500,s=3e4,c=1e3,p=50,w=p/c,_=new Set([408,500,502,503,504,522,524,599]);let S=class{constructor(b,I){this._emitter=I,this._errorBoundary=null,this._timeout=r,this._netConfig={},this._options={},this._leakyBucket={},this._lastUsedInitUrl=null,b&&(this._options=b),this._options.networkConfig&&(this._netConfig=this._options.networkConfig),this._netConfig.networkTimeoutMs&&(this._timeout=this._netConfig.networkTimeoutMs),this._fallbackResolver=new g.NetworkFallbackResolver(this._options)}setErrorBoundary(b){this._errorBoundary=b,this._errorBoundary.wrap(this),this._errorBoundary.wrap(this._fallbackResolver),this._fallbackResolver.setErrorBoundary(b)}isBeaconSupported(){return typeof navigator<"u"&&typeof navigator.sendBeacon=="function"}getLastUsedInitUrlAndReset(){const b=this._lastUsedInitUrl;return this._lastUsedInitUrl=null,b}beacon(b){return e(this,void 0,void 0,function*(){if(!E(b))return!1;const I=this._getInternalRequestArgs("POST",b);yield this._tryToCompressBody(I);const T=yield this._getPopulatedURL(I),O=navigator;return O.sendBeacon.bind(O)(T,I.body)})}post(b){return e(this,void 0,void 0,function*(){const I=this._getInternalRequestArgs("POST",b);return this._tryEncodeBody(I),yield this._tryToCompressBody(I),this._sendRequest(I)})}get(b){const I=this._getInternalRequestArgs("GET",b);return this._sendRequest(I)}_sendRequest(b){var I,T,O,U;return e(this,void 0,void 0,function*(){if(!E(b)||this._netConfig.preventAllNetworkTraffic)return null;const{method:M,body:ce,retries:$,attempt:q}=b,j=b.urlConfig.endpoint;if(this._isRateLimited(j))return v.Log.warn(`Request to ${j} was blocked because you are making requests too frequently.`),null;const N=q??1,F=typeof AbortController<"u"?new AbortController:null,ie=setTimeout(()=>{F==null||F.abort(`Timeout of ${this._timeout}ms expired.`)},this._timeout),de=yield this._getPopulatedURL(b);let K=null;const tn=(0,n._isUnloading)();try{const oe={method:M,body:ce,headers:Object.assign({},b.headers),signal:F==null?void 0:F.signal,priority:b.priority,keepalive:tn};B(b,N);const se=this._leakyBucket[j];if(se&&(se.lastRequestTime=Date.now(),this._leakyBucket[j]=se),K=yield((I=this._netConfig.networkOverrideFunc)!==null&&I!==void 0?I:fetch)(de,oe),clearTimeout(ie),!K.ok){const Ee=yield K.text().catch(()=>"No Text"),tt=new Error(`NetworkError: ${de} ${Ee}`);throw tt.name="NetworkError",tt}const ke=yield K.text();return re(b,K,N,ke),this._fallbackResolver.tryBumpExpiryTime(b.sdkKey,b.urlConfig),{body:ke,code:K.status}}catch(oe){const se=C(F,oe),et=R(F);if(re(b,K,N,"",oe),(yield this._fallbackResolver.tryFetchUpdatedFallbackInfo(b.sdkKey,b.urlConfig,se,et))&&(b.fallbackUrl=this._fallbackResolver.getActiveFallbackUrl(b.sdkKey,b.urlConfig)),!$||N>$||!_.has((T=K==null?void 0:K.status)!==null&&T!==void 0?T:500)){(O=this._emitter)===null||O===void 0||O.call(this,{name:"error",error:oe,tag:i.ErrorTag.NetworkError,requestArgs:b});const Ee=`A networking error occurred during ${M} request to ${de}.`;return v.Log.error(Ee,se,oe),(U=this._errorBoundary)===null||U===void 0||U.attachErrorIfNoneExists(Ee),null}return yield J(N),this._sendRequest(Object.assign(Object.assign({},b),{retries:$,attempt:N+1}))}})}_isRateLimited(b){var I;const T=Date.now(),O=(I=this._leakyBucket[b])!==null&&I!==void 0?I:{count:0,lastRequestTime:T},U=T-O.lastRequestTime,M=Math.floor(U*w);return O.count=Math.max(0,O.count-M),O.count>=p?!0:(O.count+=1,O.lastRequestTime=T,this._leakyBucket[b]=O,!1)}_getPopulatedURL(b){var I;return e(this,void 0,void 0,function*(){const T=(I=b.fallbackUrl)!==null&&I!==void 0?I:b.urlConfig.getUrl();(b.urlConfig.endpoint===d.Endpoint._initialize||b.urlConfig.endpoint===d.Endpoint._download_config_specs)&&(this._lastUsedInitUrl=T);const O=Object.assign({[d.NetworkParam.SdkKey]:b.sdkKey,[d.NetworkParam.SdkType]:f.SDKType._get(b.sdkKey),[d.NetworkParam.SdkVersion]:t.SDK_VERSION,[d.NetworkParam.Time]:String(Date.now()),[d.NetworkParam.SessionID]:u.SessionID.get(b.sdkKey)},b.params),U=Object.keys(O).map(M=>`${encodeURIComponent(M)}=${encodeURIComponent(O[M])}`).join("&");return`${T}${U?`?${U}`:""}`})}_tryEncodeBody(b){var I;const T=(0,h._getWindowSafe)(),O=b.body;if(!(!b.isStatsigEncodable||this._options.disableStatsigEncoding||typeof O!="string"||(0,y._getStatsigGlobalFlag)("no-encode")!=null||!(T!=null&&T.btoa)))try{b.body=T.btoa(O).split("").reverse().join(""),b.params=Object.assign(Object.assign({},(I=b.params)!==null&&I!==void 0?I:{}),{[d.NetworkParam.StatsigEncoded]:"1"})}catch(U){v.Log.warn(`Request encoding failed for ${b.urlConfig.getUrl()}`,U)}}_tryToCompressBody(b){var I;return e(this,void 0,void 0,function*(){const T=b.body;if(!(!b.isCompressable||this._options.disableCompression||typeof T!="string"||m.SDKFlags.get(b.sdkKey,"enable_log_event_compression")!==!0||(0,y._getStatsigGlobalFlag)("no-compress")!=null||typeof CompressionStream>"u"||typeof TextEncoder>"u"))try{const O=new TextEncoder().encode(T),U=new CompressionStream("gzip"),M=U.writable.getWriter();M.write(O).catch(v.Log.error),M.close().catch(v.Log.error);const ce=U.readable.getReader(),$=[];let q;for(;!(q=yield ce.read()).done;)$.push(q.value);const j=$.reduce((ie,de)=>ie+de.length,0),N=new Uint8Array(j);let F=0;for(const ie of $)N.set(ie,F),F+=ie.length;b.body=N,b.params=Object.assign(Object.assign({},(I=b.params)!==null&&I!==void 0?I:{}),{[d.NetworkParam.IsGzipped]:"1"})}catch(O){v.Log.warn(`Request compression failed for ${b.urlConfig.getUrl()}`,O)}})}_getInternalRequestArgs(b,I){const T=this._fallbackResolver.getActiveFallbackUrl(I.sdkKey,I.urlConfig),O=Object.assign(Object.assign({},I),{method:b,fallbackUrl:T});return"data"in I&&D(O,I.data),O}};Z.NetworkCore=S;const E=k=>k.sdkKey?!0:(v.Log.warn("Unable to make request without an SDK key"),!1),D=(k,b)=>{const{sdkKey:I,fallbackUrl:T}=k,O=a.StableID.get(I),U=u.SessionID.get(I),M=f.SDKType._get(I);k.body=JSON.stringify(Object.assign(Object.assign({},b),{statsigMetadata:Object.assign(Object.assign({},t.StatsigMetadataProvider.get()),{stableID:O,sessionID:U,sdkType:M,fallbackUrl:T})}))};function C(k,b){return k!=null&&k.signal.aborted&&typeof k.signal.reason=="string"?k.signal.reason:typeof b=="string"?b:b instanceof Error?`${b.name}: ${b.message}`:"Unknown Error"}function R(k){return(k==null?void 0:k.signal.aborted)&&typeof k.signal.reason=="string"&&k.signal.reason.includes("Timeout")||!1}function B(k,b){k.urlConfig.endpoint===d.Endpoint._initialize&&l.Diagnostics._markInitNetworkReqStart(k.sdkKey,{attempt:b})}function re(k,b,I,T,O){k.urlConfig.endpoint===d.Endpoint._initialize&&l.Diagnostics._markInitNetworkReqEnd(k.sdkKey,l.Diagnostics._getDiagnosticsData(b,I,T,O))}function J(k){return e(this,void 0,void 0,function*(){yield new Promise(b=>setTimeout(b,Math.min(o*(k*k),s)))})}return Z}var $e={},Nt;function _n(){return Nt||(Nt=1,Object.defineProperty($e,"__esModule",{value:!0})),$e}var Ge={},At;function fn(){return At||(At=1,Object.defineProperty(Ge,"__esModule",{value:!0})),Ge}var te={},Ft;function gn(){if(Ft)return te;Ft=1;var e=te&&te.__awaiter||function(t,n,r,o){function s(c){return c instanceof r?c:new r(function(p){p(c)})}return new(r||(r=Promise))(function(c,p){function w(E){try{S(o.next(E))}catch(D){p(D)}}function _(E){try{S(o.throw(E))}catch(D){p(D)}}function S(E){E.done?c(E.value):s(E.value).then(w,_)}S((o=o.apply(t,n||[])).next())})};Object.defineProperty(te,"__esModule",{value:!0}),te.StatsigClientBase=void 0,le();const y=le(),l=Xt(),v=xt(),d=L(),g=Yt(),m=ue(),f=Ze(),h=z(),u=3e3;let a=class{constructor(n,r,o,s){var c;this.loadingStatus="Uninitialized",this._initializePromise=null,this._listeners={};const p=this.$emt.bind(this);(s==null?void 0:s.logLevel)!=null&&(d.Log.level=s.logLevel),s!=null&&s.disableStorage&&h.Storage._setDisabled(!0),s!=null&&s.initialSessionID&&f.StatsigSession.overrideInitialSessionID(s.initialSessionID,n),s!=null&&s.storageProvider&&h.Storage._setProvider(s.storageProvider),this._sdkKey=n,this._options=s??{},this._memoCache={},this.overrideAdapter=(c=s==null?void 0:s.overrideAdapter)!==null&&c!==void 0?c:null,this._logger=new v.EventLogger(n,p,o,s),this._errorBoundary=new l.ErrorBoundary(n,s,p),this._errorBoundary.wrap(this),this._errorBoundary.wrap(r),this._errorBoundary.wrap(this._logger),o.setErrorBoundary(this._errorBoundary),this.dataAdapter=r,this.dataAdapter.attach(n,s),this.storageProvider=h.Storage,this._primeReadyRipcord(),i(n,this)}updateRuntimeOptions(n){n.disableLogging!=null&&(this._options.disableLogging=n.disableLogging,this._logger.setLoggingDisabled(n.disableLogging)),n.disableStorage!=null&&(this._options.disableStorage=n.disableStorage,h.Storage._setDisabled(n.disableStorage))}flush(){return this._logger.flush()}shutdown(){return e(this,void 0,void 0,function*(){this.$emt({name:"pre_shutdown"}),this._setStatus("Uninitialized",null),this._initializePromise=null,yield this._logger.stop()})}on(n,r){this._listeners[n]||(this._listeners[n]=[]),this._listeners[n].push(r)}off(n,r){if(this._listeners[n]){const o=this._listeners[n].indexOf(r);o!==-1&&this._listeners[n].splice(o,1)}}$on(n,r){r.__isInternal=!0,this.on(n,r)}$emt(n){var r;const o=s=>{try{s(n)}catch(c){if(s.__isInternal===!0){this._errorBoundary.logError(`__emit:${n.name}`,c);return}d.Log.error("An error occurred in a StatsigClientEvent listener. This is not an issue with Statsig.",n)}};this._listeners[n.name]&&this._listeners[n.name].forEach(s=>o(s)),(r=this._listeners["*"])===null||r===void 0||r.forEach(o)}_setStatus(n,r){this.loadingStatus=n,this._memoCache={},this.$emt({name:"values_updated",status:n,values:r})}_enqueueExposure(n,r,o){if((o==null?void 0:o.disableExposureLog)===!0){this._logger.incrementNonExposureCount(n);return}this._logger.enqueue(r)}_memoize(n,r){return(o,s)=>{if(this._options.disableEvaluationMemoization)return r(o,s);const c=(0,g.createMemoKey)(n,o,s);return c?(c in this._memoCache||(Object.keys(this._memoCache).length>=u&&(this._memoCache={}),this._memoCache[c]=r(o,s)),this._memoCache[c]):r(o,s)}}};te.StatsigClientBase=a;function i(t,n){var r;if((0,m._isServerEnv)())return;const o=(0,y._getStatsigGlobal)(),s=(r=o.instances)!==null&&r!==void 0?r:{},c=n;s[t]!=null&&d.Log.warn("Creating multiple Statsig clients with the same SDK key can lead to unexpected behavior. Multi-instance support requires different SDK keys."),s[t]=c,o.firstInstance||(o.firstInstance=c),o.instances=s,__STATSIG__=o}return te}var pe={},qt;function vn(){return qt||(qt=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.DataAdapterCachePrefix=void 0,pe.DataAdapterCachePrefix="statsig.cached"),pe}var Ve={},Kt;function hn(){return Kt||(Kt=1,Object.defineProperty(Ve,"__esModule",{value:!0})),Ve}var ze={},Bt;function yn(){return Bt||(Bt=1,Object.defineProperty(ze,"__esModule",{value:!0})),ze}var P={},$t;function Sn(){if($t)return P;$t=1,Object.defineProperty(P,"__esModule",{value:!0}),P._makeTypedGet=P._mergeOverride=P._makeLayer=P._makeExperiment=P._makeDynamicConfig=P._makeFeatureGate=void 0;const e=L(),y=xe(),l="default";function v(a,i,t,n){var r;return{name:a,details:i,ruleID:(r=t==null?void 0:t.rule_id)!==null&&r!==void 0?r:l,__evaluation:t,value:n}}function d(a,i,t){return v(a,i,t,(t==null?void 0:t.value)===!0)}P._makeFeatureGate=d;function g(a,i,t){var n;const r=(n=t==null?void 0:t.value)!==null&&n!==void 0?n:{};return Object.assign(Object.assign({},v(a,i,t,r)),{get:u(a,t==null?void 0:t.value)})}P._makeDynamicConfig=g;function m(a,i,t){var n;const r=g(a,i,t);return Object.assign(Object.assign({},r),{groupName:(n=t==null?void 0:t.group_name)!==null&&n!==void 0?n:null})}P._makeExperiment=m;function f(a,i,t,n){var r,o;return Object.assign(Object.assign({},v(a,i,t,void 0)),{get:u(a,t==null?void 0:t.value,n),groupName:(r=t==null?void 0:t.group_name)!==null&&r!==void 0?r:null,__value:(o=t==null?void 0:t.value)!==null&&o!==void 0?o:{}})}P._makeLayer=f;function h(a,i,t,n){return Object.assign(Object.assign(Object.assign({},a),i),{get:u(a.name,t,n)})}P._mergeOverride=h;function u(a,i,t){return(n,r)=>{var o;const s=(o=i==null?void 0:i[n])!==null&&o!==void 0?o:null;return s==null?r??null:r!=null&&!(0,y._isTypeMatch)(s,r)?(e.Log.warn(`Parameter type mismatch. '${a}.${n}' was found to be type '${typeof s}' but fallback/return type is '${typeof r}'. See https://docs.statsig.com/client/javascript-sdk/#typed-getters`),r??null):(t==null||t(n),s)}}return P._makeTypedGet=u,P}var Je={},Gt;function mn(){return Gt||(Gt=1,Object.defineProperty(Je,"__esModule",{value:!0})),Je}var ne={},Vt;function pn(){if(Vt)return ne;Vt=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.UPDATE_DETAIL_ERROR_MESSAGES=ne.createUpdateDetails=void 0;const e=(y,l,v,d,g,m)=>({duration:v,source:l,success:y,error:d,sourceUrl:g,warnings:m});return ne.createUpdateDetails=e,ne.UPDATE_DETAIL_ERROR_MESSAGES={NO_NETWORK_DATA:"No data was returned from the network. This may be due to a network timeout if a timeout value was specified in the options or ad blocker error."},ne}var zt;function bn(){return zt||(zt=1,function(e){var y=W&&W.__createBinding||(Object.create?function(h,u,a,i){i===void 0&&(i=a);var t=Object.getOwnPropertyDescriptor(u,a);(!t||("get"in t?!u.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return u[a]}}),Object.defineProperty(h,i,t)}:function(h,u,a,i){i===void 0&&(i=a),h[i]=u[a]}),l=W&&W.__exportStar||function(h,u){for(var a in h)a!=="default"&&!Object.prototype.hasOwnProperty.call(u,a)&&y(u,h,a)};Object.defineProperty(e,"__esModule",{value:!0}),e.Storage=e.Log=e.EventLogger=e.Diagnostics=void 0,le();const v=We();Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return v.Diagnostics}});const d=xt();Object.defineProperty(e,"EventLogger",{enumerable:!0,get:function(){return d.EventLogger}});const g=L();Object.defineProperty(e,"Log",{enumerable:!0,get:function(){return g.Log}});const m=we(),f=z();Object.defineProperty(e,"Storage",{enumerable:!0,get:function(){return f.Storage}}),l(le(),e),l(De(),e),l(nn(),e),l(rn(),e),l(We(),e),l(on(),e),l(Xt(),e),l(sn(),e),l(an(),e),l(be(),e),l(ln(),e),l(L(),e),l(Yt(),e),l(Ie(),e),l(dn(),e),l(_n(),e),l(fn(),e),l(ue(),e),l(Ye(),e),l(Ze(),e),l(Xe(),e),l(gn(),e),l(en(),e),l(vn(),e),l(Jt(),e),l(we(),e),l(hn(),e),l(yn(),e),l(Sn(),e),l(mn(),e),l(Ht(),e),l(z(),e),l(Qt(),e),l(xe(),e),l(Wt(),e),l(Qe(),e),l(He(),e),l(pn(),e),l(Zt(),e),__STATSIG__=Object.assign(Object.assign({},__STATSIG__!=null?__STATSIG__:{}),{Log:g.Log,SDK_VERSION:m.SDK_VERSION})}(W)),W}var Rn=bn();export{En as a,nt as c,wn as g,bn as r,Rn as s};

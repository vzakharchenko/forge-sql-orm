var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function kn(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var y=e.default;if(typeof y=="function"){var u=function f(){return this instanceof f?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};u.prototype=y.prototype}else u={};return Object.defineProperty(u,"__esModule",{value:!0}),Object.keys(e).forEach(function(f){var v=Object.getOwnPropertyDescriptor(e,f);Object.defineProperty(u,f,v.get?v:{enumerable:!0,get:function(){return e[f]}})}),u}var X={},Me={},Le={},st;function N(){return st||(st=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Log=e.LogLevel=void 0;const y=" DEBUG ",u="  INFO ",f="  WARN ",v=" ERROR ";function _(p){return p.unshift("[Statsig]"),p}e.LogLevel={None:0,Error:1,Warn:2,Info:3,Debug:4};class b{static info(...h){b.level>=e.LogLevel.Info&&console.info(u,..._(h))}static debug(...h){b.level>=e.LogLevel.Debug&&console.debug(y,..._(h))}static warn(...h){b.level>=e.LogLevel.Warn&&console.warn(f,..._(h))}static error(...h){b.level>=e.LogLevel.Error&&console.error(v,..._(h))}}e.Log=b,b.level=e.LogLevel.Warn}(Le)),Le}var at;function H(){return at||(at=1,function(e){var y,u,f;Object.defineProperty(e,"__esModule",{value:!0}),e._getInstance=e._getStatsigGlobalFlag=e._getStatsigGlobal=void 0;const v=N(),_=()=>{try{return typeof __STATSIG__<"u"?__STATSIG__:r}catch{return r}};e._getStatsigGlobal=_;const b=i=>(0,e._getStatsigGlobal)()[i];e._getStatsigGlobalFlag=b;const p=i=>{const t=(0,e._getStatsigGlobal)();return i?t.instances&&t.instances[i]:(t.instances&&Object.keys(t.instances).length>1&&v.Log.warn("Call made to Statsig global instance without an SDK key but there is more than one client instance. If you are using mulitple clients, please specify the SDK key."),t.firstInstance)};e._getInstance=p;const h="__STATSIG__",d=typeof window<"u"?window:{},l=typeof ot<"u"?ot:{},o=typeof globalThis<"u"?globalThis:{},r=(f=(u=(y=d[h])!==null&&y!==void 0?y:l[h])!==null&&u!==void 0?u:o[h])!==null&&f!==void 0?f:{instance:e._getInstance};d[h]=r,l[h]=r,o[h]=r}(Me)),Me}var Pe={},lt;function Xe(){return lt||(lt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Diagnostics=void 0;const y=new Map,u="start",f="end",v="statsig::diagnostics";e.Diagnostics={_getMarkers:d=>y.get(d),_markInitOverallStart:d=>{p(d,_({},u,"overall"))},_markInitOverallEnd:(d,l,o)=>{p(d,_({success:l,error:l?void 0:{name:"InitializeError",message:"Failed to initialize"},evaluationDetails:o},f,"overall"))},_markInitNetworkReqStart:(d,l)=>{p(d,_(l,u,"initialize","network_request"))},_markInitNetworkReqEnd:(d,l)=>{p(d,_(l,f,"initialize","network_request"))},_markInitProcessStart:d=>{p(d,_({},u,"initialize","process"))},_markInitProcessEnd:(d,l)=>{p(d,_(l,f,"initialize","process"))},_clearMarkers:d=>{y.delete(d)},_formatError(d){if(d&&typeof d=="object")return{code:h(d,"code"),name:h(d,"name"),message:h(d,"message")}},_getDiagnosticsData(d,l,o,r){var i;return{success:(d==null?void 0:d.ok)===!0,statusCode:d==null?void 0:d.status,sdkRegion:(i=d==null?void 0:d.headers)===null||i===void 0?void 0:i.get("x-statsig-region"),isDelta:o.includes('"is_delta":true')===!0?!0:void 0,attempt:l,error:e.Diagnostics._formatError(r)}},_enqueueDiagnosticsEvent(d,l,o,r){const i=e.Diagnostics._getMarkers(o);if(i==null||i.length<=0)return-1;const t=i[i.length-1].timestamp-i[0].timestamp;e.Diagnostics._clearMarkers(o);const n=b(d,{context:"initialize",markers:i.slice(),statsigOptions:r});return l.enqueue(n),t}};function _(d,l,o,r){return Object.assign({key:o,action:l,step:r,timestamp:Date.now()},d)}function b(d,l){return{eventName:v,user:d,value:null,metadata:l,time:Date.now()}}function p(d,l){var o;const r=(o=y.get(d))!==null&&o!==void 0?o:[];r.push(l),y.set(d,r)}function h(d,l){if(l in d)return d[l]}}(Pe)),Pe}var Y={},Z={},je={},ee={},ut;function Ye(){if(ut)return ee;ut=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee._isTypeMatch=ee._typeOf=void 0;function e(u){return Array.isArray(u)?"array":typeof u}ee._typeOf=e;function y(u,f){const v=_=>Array.isArray(_)?"array":typeof _;return v(u)===v(f)}return ee._isTypeMatch=y,ee}var ct;function ge(){return ct||(ct=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._getSortedObject=e._DJB2Object=e._DJB2=void 0;const y=Ye(),u=_=>{let b=0;for(let p=0;p<_.length;p++){const h=_.charCodeAt(p);b=(b<<5)-b+h,b=b&b}return String(b>>>0)};e._DJB2=u;const f=(_,b)=>(0,e._DJB2)(JSON.stringify((0,e._getSortedObject)(_,b)));e._DJB2Object=f;const v=(_,b)=>{if(_==null)return null;const p=Object.keys(_).sort(),h={};return p.forEach(d=>{const l=_[d];if(b===0||(0,y._typeOf)(l)!=="object"){h[d]=l;return}h[d]=(0,e._getSortedObject)(l,b!=null?b-1:b)}),h};e._getSortedObject=v}(je)),je}var dt;function Ie(){if(dt)return Z;dt=1,Object.defineProperty(Z,"__esModule",{value:!0}),Z._getStorageKey=Z._getUserStorageKey=void 0;const e=ge();function y(f,v,_){var b;if(_)return _(f,v);const p=v&&v.customIDs?v.customIDs:{},h=[`uid:${(b=v==null?void 0:v.userID)!==null&&b!==void 0?b:""}`,`cids:${Object.keys(p).sort((d,l)=>d.localeCompare(l)).map(d=>`${d}-${p[d]}`).join(",")}`,`k:${f}`];return(0,e._DJB2)(h.join("|"))}Z._getUserStorageKey=y;function u(f,v,_){return v?y(f,v,_):(0,e._DJB2)(`k:${f}`)}return Z._getStorageKey=u,Z}var Ne={},_t;function Ce(){return _t||(_t=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NetworkParam=e.NetworkDefault=e.Endpoint=void 0,e.Endpoint={_initialize:"initialize",_rgstr:"rgstr",_download_config_specs:"download_config_specs"},e.NetworkDefault={[e.Endpoint._rgstr]:"https://prodregistryv2.org/v1",[e.Endpoint._initialize]:"https://featureassets.org/v1",[e.Endpoint._download_config_specs]:"https://api.statsigcdn.com/v1"},e.NetworkParam={EventCount:"ec",SdkKey:"k",SdkType:"st",SdkVersion:"sv",Time:"t",SessionID:"sid",StatsigEncoded:"se",IsGzipped:"gz"}}(Ne)),Ne}var Ae={},gt;function le(){return gt||(gt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._getUnloadEvent=e._getCurrentPageUrlSafe=e._addDocumentEventListenerSafe=e._addWindowEventListenerSafe=e._isServerEnv=e._getDocumentSafe=e._getWindowSafe=void 0;const y=()=>typeof window<"u"?window:null;e._getWindowSafe=y;const u=()=>{var h;const d=(0,e._getWindowSafe)();return(h=d==null?void 0:d.document)!==null&&h!==void 0?h:null};e._getDocumentSafe=u;const f=()=>{if((0,e._getDocumentSafe)()!==null)return!1;const h=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;return typeof EdgeRuntime=="string"||h};e._isServerEnv=f;const v=(h,d)=>{const l=(0,e._getWindowSafe)();typeof(l==null?void 0:l.addEventListener)=="function"&&l.addEventListener(h,d)};e._addWindowEventListenerSafe=v;const _=(h,d)=>{const l=(0,e._getDocumentSafe)();typeof(l==null?void 0:l.addEventListener)=="function"&&l.addEventListener(h,d)};e._addDocumentEventListenerSafe=_;const b=()=>{var h;try{return(h=(0,e._getWindowSafe)())===null||h===void 0?void 0:h.location.href.split(/[?#]/)[0]}catch{return}};e._getCurrentPageUrlSafe=b;const p=()=>{const h=(0,e._getWindowSafe)();return h&&"onpagehide"in h?"pagehide":"beforeunload"};e._getUnloadEvent=p}(Ae)),Ae}var q={},ft;function Ht(){if(ft)return q;ft=1,Object.defineProperty(q,"__esModule",{value:!0}),q._createLayerParameterExposure=q._createConfigExposure=q._mapExposures=q._createGateExposure=q._isExposureEvent=void 0;const e="statsig::config_exposure",y="statsig::gate_exposure",u="statsig::layer_exposure",f=(l,o,r,i,t)=>(r.bootstrapMetadata&&(i.bootstrapMetadata=r.bootstrapMetadata),{eventName:l,user:o,value:null,metadata:d(r,i),secondaryExposures:t,time:Date.now()}),v=({eventName:l})=>l===y||l===e||l===u;q._isExposureEvent=v;const _=(l,o,r)=>{var i,t,n;const a={gate:o.name,gateValue:String(o.value),ruleID:o.ruleID};return((i=o.__evaluation)===null||i===void 0?void 0:i.version)!=null&&(a.configVersion=o.__evaluation.version),f(y,l,o.details,a,b((n=(t=o.__evaluation)===null||t===void 0?void 0:t.secondary_exposures)!==null&&n!==void 0?n:[],r))};q._createGateExposure=_;function b(l,o){return l.map(r=>typeof r=="string"?(o??{})[r]:r).filter(r=>r!=null)}q._mapExposures=b;const p=(l,o,r)=>{var i,t,n,a;const g={config:o.name,ruleID:o.ruleID};return((i=o.__evaluation)===null||i===void 0?void 0:i.version)!=null&&(g.configVersion=o.__evaluation.version),((t=o.__evaluation)===null||t===void 0?void 0:t.passed)!=null&&(g.rulePassed=String(o.__evaluation.passed)),f(e,l,o.details,g,b((a=(n=o.__evaluation)===null||n===void 0?void 0:n.secondary_exposures)!==null&&a!==void 0?a:[],r))};q._createConfigExposure=p;const h=(l,o,r,i)=>{var t,n,a,g;const s=o.__evaluation,E=((t=s==null?void 0:s.explicit_parameters)===null||t===void 0?void 0:t.includes(r))===!0;let w="",c=(n=s==null?void 0:s.undelegated_secondary_exposures)!==null&&n!==void 0?n:[];E&&(w=(a=s.allocated_experiment_name)!==null&&a!==void 0?a:"",c=s.secondary_exposures);const m={config:o.name,parameterName:r,ruleID:o.ruleID,allocatedExperiment:w,isExplicitParameter:String(E)};return((g=o.__evaluation)===null||g===void 0?void 0:g.version)!=null&&(m.configVersion=o.__evaluation.version),f(u,l,o.details,m,b(c,i))};q._createLayerParameterExposure=h;const d=(l,o)=>(o.reason=l.reason,l.lcut&&(o.lcut=String(l.lcut)),l.receivedAt&&(o.receivedAt=String(l.receivedAt)),o);return q}var te={},vt;function Te(){return vt||(vt=1,Object.defineProperty(te,"__esModule",{value:!0}),te.LoggingEnabledOption=te.LogEventCompressionMode=void 0,te.LogEventCompressionMode={Disabled:"d",Enabled:"e",Forced:"f"},te.LoggingEnabledOption={disabled:"disabled",browserOnly:"browser-only",always:"always"}),te}var Fe={},ht;function Q(){return ht||(ht=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._setObjectInStorage=e._getObjectFromStorage=e.Storage=void 0;const y=N(),u=le(),f={},v={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"InMemory",getItem:o=>f[o]?f[o]:null,setItem:(o,r)=>{f[o]=r},removeItem:o=>{delete f[o]},getAllKeys:()=>Object.keys(f)};let _=null;try{const o=(0,u._getWindowSafe)();o&&o.localStorage&&typeof o.localStorage.getItem=="function"&&(_={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"LocalStorage",getItem:r=>o.localStorage.getItem(r),setItem:(r,i)=>o.localStorage.setItem(r,i),removeItem:r=>o.localStorage.removeItem(r),getAllKeys:()=>Object.keys(o.localStorage)})}catch{y.Log.warn("Failed to setup localStorageProvider.")}let b=_??v,p=b;function h(o){try{return o()}catch(r){if(r instanceof Error&&r.name==="SecurityError")return e.Storage._setProvider(v),null;if(r instanceof Error&&r.name==="QuotaExceededError"){const t=e.Storage.getAllKeys().filter(n=>n.startsWith("statsig."));r.message=`${r.message}. Statsig Keys: ${t.length}`}throw r}}e.Storage={isReady:()=>p.isReady(),isReadyResolver:()=>p.isReadyResolver(),getProviderName:()=>p.getProviderName(),getItem:o=>h(()=>p.getItem(o)),setItem:(o,r)=>h(()=>p.setItem(o,r)),removeItem:o=>p.removeItem(o),getAllKeys:()=>p.getAllKeys(),_setProvider:o=>{b=o,p=o},_setDisabled:o=>{o?p=v:p=b}};function d(o){const r=e.Storage.getItem(o);return JSON.parse(r??"null")}e._getObjectFromStorage=d;function l(o,r){e.Storage.setItem(o,JSON.stringify(r))}e._setObjectInStorage=l}(Fe)),Fe}var he={},yt;function Qt(){if(yt)return he;yt=1,Object.defineProperty(he,"__esModule",{value:!0}),he.UrlConfiguration=void 0;const e=ge(),y=Ce(),u={[y.Endpoint._initialize]:"i",[y.Endpoint._rgstr]:"e",[y.Endpoint._download_config_specs]:"d"};let f=class{constructor(_,b,p,h){this.customUrl=null,this.fallbackUrls=null,this.endpoint=_,this.endpointDnsKey=u[_],b&&(this.customUrl=b),!b&&p&&(this.customUrl=p.endsWith("/")?`${p}${_}`:`${p}/${_}`),h&&(this.fallbackUrls=h);const d=y.NetworkDefault[_];this.defaultUrl=`${d}/${_}`}getUrl(){var _;return(_=this.customUrl)!==null&&_!==void 0?_:this.defaultUrl}getChecksum(){var _;const b=((_=this.fallbackUrls)!==null&&_!==void 0?_:[]).sort().join(",");return(0,e._DJB2)(this.customUrl+b)}};return he.UrlConfiguration=f,he}var qe={},mt;function Ze(){return mt||(mt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._notifyVisibilityChanged=e._subscribeToVisiblityChanged=e._isUnloading=e._isCurrentlyVisible=void 0;const y=le(),u="foreground",f="background",v=[];let _=u,b=!1;const p=()=>_===u;e._isCurrentlyVisible=p;const h=()=>b;e._isUnloading=h;const d=o=>{v.unshift(o)};e._subscribeToVisiblityChanged=d;const l=o=>{o!==_&&(_=o,v.forEach(r=>r(o)))};e._notifyVisibilityChanged=l,(0,y._addWindowEventListenerSafe)("focus",()=>{b=!1,(0,e._notifyVisibilityChanged)(u)}),(0,y._addWindowEventListenerSafe)("blur",()=>(0,e._notifyVisibilityChanged)(f)),(0,y._addDocumentEventListenerSafe)("visibilitychange",()=>{(0,e._notifyVisibilityChanged)(document.visibilityState==="visible"?u:f)}),(0,y._addWindowEventListenerSafe)((0,y._getUnloadEvent)(),()=>{b=!0,(0,e._notifyVisibilityChanged)(f)})}(qe)),qe}var St;function Xt(){if(St)return Y;St=1;var e=Y&&Y.__awaiter||function(w,c,m,D){function O(R){return R instanceof m?R:new m(function(L){L(R)})}return new(m||(m=Promise))(function(R,L){function M(B){try{x(D.next(B))}catch(I){L(I)}}function W(B){try{x(D.throw(B))}catch(I){L(I)}}function x(B){B.done?R(B.value):O(B.value).then(M,W)}x((D=D.apply(w,c||[])).next())})};Object.defineProperty(Y,"__esModule",{value:!0}),Y.EventLogger=void 0;const y=Ie(),u=ge(),f=N(),v=Ce(),_=le(),b=Ht(),p=Te(),h=Q(),d=Qt(),l=Ze(),o=100,r=1e4,i=1e3,t=6e5,n=500,a=200,g={},s={Startup:"startup",GainedFocus:"gained_focus"};let E=class _e{static _safeFlushAndForget(c){var m;(m=g[c])===null||m===void 0||m.flush().catch(()=>{})}static _safeRetryFailedLogs(c){var m;(m=g[c])===null||m===void 0||m._retryFailedLogs(s.GainedFocus)}constructor(c,m,D,O){var R,L;this._sdkKey=c,this._emitter=m,this._network=D,this._options=O,this._queue=[],this._lastExposureTimeMap={},this._nonExposedChecks={},this._hasRunQuickFlush=!1,this._creationTime=Date.now(),this._loggingEnabled=(R=O==null?void 0:O.loggingEnabled)!==null&&R!==void 0?R:(O==null?void 0:O.disableLogging)===!0?p.LoggingEnabledOption.disabled:p.LoggingEnabledOption.browserOnly,O!=null&&O.loggingEnabled&&O.disableLogging!==void 0&&f.Log.warn("Detected both loggingEnabled and disableLogging options. loggingEnabled takes precedence - please remove disableLogging."),this._maxQueueSize=(L=O==null?void 0:O.loggingBufferMaxSize)!==null&&L!==void 0?L:o;const M=O==null?void 0:O.networkConfig;this._logEventUrlConfig=new d.UrlConfiguration(v.Endpoint._rgstr,M==null?void 0:M.logEventUrl,M==null?void 0:M.api,M==null?void 0:M.logEventFallbackUrls)}setLogEventCompressionMode(c){this._network.setLogEventCompressionMode(c)}setLoggingEnabled(c){this._loggingEnabled=c}enqueue(c){this._shouldLogEvent(c)&&(this._normalizeAndAppendEvent(c),this._quickFlushIfNeeded(),this._queue.length>this._maxQueueSize&&_e._safeFlushAndForget(this._sdkKey))}incrementNonExposureCount(c){var m;const D=(m=this._nonExposedChecks[c])!==null&&m!==void 0?m:0;this._nonExposedChecks[c]=D+1}reset(){this._lastExposureTimeMap={}}start(){var c;const m=(0,_._isServerEnv)();m&&((c=this._options)===null||c===void 0?void 0:c.loggingEnabled)!=="always"||(g[this._sdkKey]=this,m||(0,l._subscribeToVisiblityChanged)(D=>{D==="background"?_e._safeFlushAndForget(this._sdkKey):D==="foreground"&&_e._safeRetryFailedLogs(this._sdkKey)}),this._retryFailedLogs(s.Startup),this._startBackgroundFlushInterval())}stop(){return e(this,void 0,void 0,function*(){this._flushIntervalId&&(clearInterval(this._flushIntervalId),this._flushIntervalId=null),delete g[this._sdkKey],yield this.flush()})}flush(){return e(this,void 0,void 0,function*(){if(this._appendAndResetNonExposedChecks(),this._queue.length===0)return;const c=this._queue;this._queue=[],yield this._sendEvents(c)})}_quickFlushIfNeeded(){this._hasRunQuickFlush||(this._hasRunQuickFlush=!0,!(Date.now()-this._creationTime>a)&&setTimeout(()=>_e._safeFlushAndForget(this._sdkKey),a))}_shouldLogEvent(c){var m;if(((m=this._options)===null||m===void 0?void 0:m.loggingEnabled)!=="always"&&(0,_._isServerEnv)())return!1;if(!(0,b._isExposureEvent)(c))return!0;const D=c.user?c.user:{statsigEnvironment:void 0},O=(0,y._getUserStorageKey)(this._sdkKey,D),R=c.metadata?c.metadata:{},L=[c.eventName,O,R.gate,R.config,R.ruleID,R.allocatedExperiment,R.parameterName,String(R.isExplicitParameter),R.reason].join("|"),M=this._lastExposureTimeMap[L],W=Date.now();return M&&W-M<t?!1:(Object.keys(this._lastExposureTimeMap).length>i&&(this._lastExposureTimeMap={}),this._lastExposureTimeMap[L]=W,!0)}_sendEvents(c){var m,D;return e(this,void 0,void 0,function*(){if(this._loggingEnabled==="disabled")return this._saveFailedLogsToStorage(c),!1;try{const R=(0,l._isUnloading)()&&this._network.isBeaconSupported()&&((D=(m=this._options)===null||m===void 0?void 0:m.networkConfig)===null||D===void 0?void 0:D.networkOverrideFunc)==null;return this._emitter({name:"pre_logs_flushed",events:c}),(R?yield this._sendEventsViaBeacon(c):yield this._sendEventsViaPost(c)).success?(this._emitter({name:"logs_flushed",events:c}),!0):(f.Log.warn("Failed to flush events."),this._saveFailedLogsToStorage(c),!1)}catch{return f.Log.warn("Failed to flush events."),!1}})}_sendEventsViaPost(c){var m;return e(this,void 0,void 0,function*(){const D=yield this._network.post(this._getRequestData(c)),O=(m=D==null?void 0:D.code)!==null&&m!==void 0?m:-1;return{success:O>=200&&O<300}})}_sendEventsViaBeacon(c){return e(this,void 0,void 0,function*(){return{success:yield this._network.beacon(this._getRequestData(c))}})}_getRequestData(c){return{sdkKey:this._sdkKey,data:{events:c},urlConfig:this._logEventUrlConfig,retries:3,isCompressable:!0,params:{[v.NetworkParam.EventCount]:String(c.length)},credentials:"same-origin"}}_saveFailedLogsToStorage(c){for(;c.length>n;)c.shift();const m=this._getStorageKey();try{(0,h._setObjectInStorage)(m,c)}catch{f.Log.warn("Unable to save failed logs to storage")}}_retryFailedLogs(c){const m=this._getStorageKey();e(this,void 0,void 0,function*(){h.Storage.isReady()||(yield h.Storage.isReadyResolver());const D=(0,h._getObjectFromStorage)(m);if(!D)return;c===s.Startup&&h.Storage.removeItem(m),(yield this._sendEvents(D))&&c===s.GainedFocus&&h.Storage.removeItem(m)}).catch(()=>{f.Log.warn("Failed to flush stored logs")})}_getStorageKey(){return`statsig.failed_logs.${(0,u._DJB2)(this._sdkKey)}`}_normalizeAndAppendEvent(c){c.user&&(c.user=Object.assign({},c.user),delete c.user.privateAttributes);const m={},D=this._getCurrentPageUrl();D&&(m.statsigMetadata={currentPage:D});const O=Object.assign(Object.assign({},c),m);f.Log.debug("Enqueued Event:",O),this._queue.push(O)}_appendAndResetNonExposedChecks(){Object.keys(this._nonExposedChecks).length!==0&&(this._normalizeAndAppendEvent({eventName:"statsig::non_exposed_checks",user:null,time:Date.now(),metadata:{checks:Object.assign({},this._nonExposedChecks)}}),this._nonExposedChecks={})}_getCurrentPageUrl(){var c;if(((c=this._options)===null||c===void 0?void 0:c.includeCurrentPageUrlWithEvents)!==!1)return(0,_._getCurrentPageUrlSafe)()}_startBackgroundFlushInterval(){var c,m;const D=(m=(c=this._options)===null||c===void 0?void 0:c.loggingIntervalMs)!==null&&m!==void 0?m:r,O=setInterval(()=>{const R=g[this._sdkKey];!R||R._flushIntervalId!==O?clearInterval(O):_e._safeFlushAndForget(this._sdkKey)},D);this._flushIntervalId=O}};return Y.EventLogger=E,Y}var Ke={},bt;function Oe(){return bt||(bt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StatsigMetadataProvider=e.SDK_VERSION=void 0,e.SDK_VERSION="3.16.0";let y={sdkVersion:e.SDK_VERSION,sdkType:"js-mono"};e.StatsigMetadataProvider={get:()=>y,add:u=>{y=Object.assign(Object.assign({},y),u)}}}(Ke)),Ke}var Be={},pt;function sn(){return pt||(pt=1,Object.defineProperty(Be,"__esModule",{value:!0})),Be}var J={},ye={},me={},Et;function et(){if(Et)return me;Et=1,Object.defineProperty(me,"__esModule",{value:!0}),me.getUUID=void 0;function e(){if(typeof crypto<"u"&&typeof crypto.randomUUID=="function")return crypto.randomUUID();let y=new Date().getTime(),u=typeof performance<"u"&&performance.now&&performance.now()*1e3||0;return`xxxxxxxx-xxxx-4xxx-${"89ab"[Math.floor(Math.random()*4)]}xxx-xxxxxxxxxxxx`.replace(/[xy]/g,v=>{let _=Math.random()*16;return y>0?(_=(y+_)%16|0,y=Math.floor(y/16)):(_=(u+_)%16|0,u=Math.floor(u/16)),(v==="x"?_:_&7|8).toString(16)})}return me.getUUID=e,me}var wt;function Re(){if(wt)return ye;wt=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.StableID=void 0;const e=Ie(),y=N(),u=le(),f=Q(),v=et(),_={},b={},p={};ye.StableID={cookiesEnabled:!1,randomID:Math.random().toString(36),get:t=>{if(p[t])return null;if(_[t]!=null)return _[t];let n=null;return n=o(t),n!=null?(_[t]=n,d(n,t),n):(n=l(t),n==null&&(n=(0,v.getUUID)()),d(n,t),r(n,t),_[t]=n,n)},setOverride:(t,n)=>{_[n]=t,d(t,n),r(t,n)},_setCookiesEnabled:(t,n)=>{b[t]=n},_setDisabled:(t,n)=>{p[t]=n}};function h(t){return`statsig.stable_id.${(0,e._getStorageKey)(t)}`}function d(t,n){const a=h(n);try{(0,f._setObjectInStorage)(a,t)}catch{y.Log.warn("Failed to save StableID to storage")}}function l(t){const n=h(t);return(0,f._getObjectFromStorage)(n)}function o(t){if(!b[t]||(0,u._getDocumentSafe)()==null)return null;const n=document.cookie.split(";");for(const a of n){const[g,s]=a.trim().split("=");if(g===i(t))return decodeURIComponent(s)}return null}function r(t,n){if(!b[n]||!document)return;const a=new Date;a.setFullYear(a.getFullYear()+1),document.cookie=`${i(n)}=${encodeURIComponent(t)}; expires=${a.toUTCString()}; path=/`}function i(t){return`statsig.stable_id.${(0,e._getStorageKey)(t)}`}return ye}var ne={},Dt;function Yt(){if(Dt)return ne;Dt=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne._getFullUserHash=ne._normalizeUser=void 0;const e=ge(),y=N();function u(v,_,b){try{const p=JSON.parse(JSON.stringify(v));return _!=null&&_.environment!=null?p.statsigEnvironment=_.environment:b!=null&&(p.statsigEnvironment={tier:b}),p}catch{return y.Log.error("Failed to JSON.stringify user"),{statsigEnvironment:void 0}}}ne._normalizeUser=u;function f(v){return v?(0,e._DJB2Object)(v):null}return ne._getFullUserHash=f,ne}var Se={},kt;function Zt(){if(kt)return Se;kt=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se._typedJsonParse=void 0;const e=N();function y(u,f,v){try{const _=JSON.parse(u);if(_&&typeof _=="object"&&f in _)return _}catch{}return e.Log.error(`Failed to parse ${v}`),null}return Se._typedJsonParse=y,Se}var Ot;function an(){if(Ot)return J;Ot=1;var e=J&&J.__awaiter||function(o,r,i,t){function n(a){return a instanceof i?a:new i(function(g){g(a)})}return new(i||(i=Promise))(function(a,g){function s(c){try{w(t.next(c))}catch(m){g(m)}}function E(c){try{w(t.throw(c))}catch(m){g(m)}}function w(c){c.done?a(c.value):n(c.value).then(s,E)}w((t=t.apply(o,r||[])).next())})};Object.defineProperty(J,"__esModule",{value:!0}),J._makeDataAdapterResult=J.DataAdapterCore=void 0;const y=N(),u=Re(),f=Yt(),v=Q(),_=Zt(),b=10;let p=class{constructor(r,i){this._adapterName=r,this._cacheSuffix=i,this._options=null,this._sdkKey=null,this._lastModifiedStoreKey=`statsig.last_modified_time.${i}`,this._inMemoryCache=new d}attach(r,i,t){this._sdkKey=r,this._options=i}getDataSync(r){const i=r&&(0,f._normalizeUser)(r,this._options),t=this._getCacheKey(i),n=this._inMemoryCache.get(t,i);if(n)return n;const a=this._loadFromCache(t);return a?(this._inMemoryCache.add(t,a),this._inMemoryCache.get(t,i)):null}setData(r,i){const t=i&&(0,f._normalizeUser)(i,this._options),n=this._getCacheKey(t);this._inMemoryCache.add(n,h("Bootstrap",r,null,t))}_getDataAsyncImpl(r,i,t){return e(this,void 0,void 0,function*(){v.Storage.isReady()||(yield v.Storage.isReadyResolver());const n=r??this.getDataSync(i),a=[this._fetchAndPrepFromNetwork(n,i,t)];return t!=null&&t.timeoutMs&&a.push(new Promise(g=>setTimeout(g,t.timeoutMs)).then(()=>(y.Log.debug("Fetching latest value timed out"),null))),yield Promise.race(a)})}_prefetchDataImpl(r,i){return e(this,void 0,void 0,function*(){const t=r&&(0,f._normalizeUser)(r,this._options),n=this._getCacheKey(t),a=yield this._getDataAsyncImpl(null,t,i);a&&this._inMemoryCache.add(n,Object.assign(Object.assign({},a),{source:"Prefetch"}))})}_fetchAndPrepFromNetwork(r,i,t){var n;return e(this,void 0,void 0,function*(){const a=(n=r==null?void 0:r.data)!==null&&n!==void 0?n:null,g=r!=null&&this._isCachedResultValidFor204(r,i),s=yield this._fetchFromNetwork(a,i,t,g);if(!s)return y.Log.debug("No response returned for latest value"),null;const E=(0,_._typedJsonParse)(s,"has_updates","Response"),w=this._getSdkKey(),c=u.StableID.get(w);let m=null;if((E==null?void 0:E.has_updates)===!0)m=h("Network",s,c,i);else if(a&&(E==null?void 0:E.has_updates)===!1)m=h("NetworkNotModified",a,c,i);else return null;const D=this._getCacheKey(i);return this._inMemoryCache.add(D,m),this._writeToCache(D,m),m})}_getSdkKey(){return this._sdkKey!=null?this._sdkKey:(y.Log.error(`${this._adapterName} is not attached to a Client`),"")}_loadFromCache(r){var i;const t=(i=v.Storage.getItem)===null||i===void 0?void 0:i.call(v.Storage,r);if(t==null)return null;const n=(0,_._typedJsonParse)(t,"source","Cached Result");return n?Object.assign(Object.assign({},n),{source:"Cache"}):null}_writeToCache(r,i){v.Storage.setItem(r,JSON.stringify(i)),this._runLocalStorageCacheEviction(r)}_runLocalStorageCacheEviction(r){var i;const t=(i=(0,v._getObjectFromStorage)(this._lastModifiedStoreKey))!==null&&i!==void 0?i:{};t[r]=Date.now();const n=l(t,b);n&&(delete t[n],v.Storage.removeItem(n)),(0,v._setObjectInStorage)(this._lastModifiedStoreKey,t)}};J.DataAdapterCore=p;function h(o,r,i,t){return{source:o,data:r,receivedAt:Date.now(),stableID:i,fullUserHash:(0,f._getFullUserHash)(t)}}J._makeDataAdapterResult=h;class d{constructor(){this._data={}}get(r,i){var t;const n=this._data[r],a=n==null?void 0:n.stableID,g=(t=i==null?void 0:i.customIDs)===null||t===void 0?void 0:t.stableID;return g&&a&&g!==a?(y.Log.warn("'StatsigUser.customIDs.stableID' mismatch"),null):n}add(r,i){const t=l(this._data,b-1);t&&delete this._data[t],this._data[r]=i}merge(r){this._data=Object.assign(Object.assign({},this._data),r)}}function l(o,r){const i=Object.keys(o);return i.length<=r?null:i.reduce((t,n)=>{const a=o[t],g=o[n];return typeof a=="object"&&typeof g=="object"?g.receivedAt<a.receivedAt?n:t:g<a?n:t})}return J}var $e={},It;function ln(){return It||(It=1,Object.defineProperty($e,"__esModule",{value:!0})),$e}var be={},pe={},Ct;function tt(){if(Ct)return pe;Ct=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.SDKType=void 0;const e={};let y;return pe.SDKType={_get:u=>{var f;return((f=e[u])!==null&&f!==void 0?f:"js-mono")+(y??"")},_setClientType(u,f){e[u]=f},_setBindingType(u){(!y||y==="-react")&&(y="-"+u)}},pe}var Tt;function en(){return Tt||(Tt=1,function(e){var y=be&&be.__awaiter||function(o,r,i,t){function n(a){return a instanceof i?a:new i(function(g){g(a)})}return new(i||(i=Promise))(function(a,g){function s(c){try{w(t.next(c))}catch(m){g(m)}}function E(c){try{w(t.throw(c))}catch(m){g(m)}}function w(c){c.done?a(c.value):n(c.value).then(s,E)}w((t=t.apply(o,r||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorBoundary=e.EXCEPTION_ENDPOINT=void 0;const u=N(),f=tt(),v=Oe();e.EXCEPTION_ENDPOINT="https://statsigapi.net/v1/sdk_exception";const _="[Statsig] UnknownError";let b=class{constructor(r,i,t,n){this._sdkKey=r,this._options=i,this._emitter=t,this._lastSeenError=n,this._seen=new Set}wrap(r){try{const i=r;d(i).forEach(t=>{const n=i[t];"$EB"in n||(i[t]=(...a)=>this._capture(t,()=>n.apply(r,a)),i[t].$EB=!0)})}catch(i){this._onError("eb:wrap",i)}}logError(r,i){this._onError(r,i)}getLastSeenErrorAndReset(){const r=this._lastSeenError;return this._lastSeenError=void 0,r??null}attachErrorIfNoneExists(r){this._lastSeenError||(this._lastSeenError=p(r))}_capture(r,i){try{const t=i();return t&&t instanceof Promise?t.catch(n=>this._onError(r,n)):t}catch(t){return this._onError(r,t),null}}_onError(r,i){try{u.Log.warn(`Caught error in ${r}`,{error:i}),y(this,void 0,void 0,function*(){var n,a,g,s,E,w,c;const m=i||Error(_),D=m instanceof Error,O=D?m.name:"No Name",R=p(m);if(this._lastSeenError=R,this._seen.has(O))return;if(this._seen.add(O),!((a=(n=this._options)===null||n===void 0?void 0:n.networkConfig)===null||a===void 0)&&a.preventAllNetworkTraffic){(g=this._emitter)===null||g===void 0||g.call(this,{name:"error",error:i,tag:r});return}const L=f.SDKType._get(this._sdkKey),M=v.StatsigMetadataProvider.get(),W=D?m.stack:h(m),x=Object.assign({tag:r,exception:O,info:W,statsigOptions:l(this._options)},Object.assign(Object.assign({},M),{sdkType:L}));yield((w=(E=(s=this._options)===null||s===void 0?void 0:s.networkConfig)===null||E===void 0?void 0:E.networkOverrideFunc)!==null&&w!==void 0?w:fetch)(e.EXCEPTION_ENDPOINT,{method:"POST",headers:{"STATSIG-API-KEY":this._sdkKey,"STATSIG-SDK-TYPE":String(L),"STATSIG-SDK-VERSION":String(M.sdkVersion),"Content-Type":"application/json"},body:JSON.stringify(x)}),(c=this._emitter)===null||c===void 0||c.call(this,{name:"error",error:i,tag:r})}).then(()=>{}).catch(()=>{})}catch{}}};e.ErrorBoundary=b;function p(o){return o instanceof Error?o:typeof o=="string"?new Error(o):new Error("An unknown error occurred.")}function h(o){try{return JSON.stringify(o)}catch{return _}}function d(o){const r=new Set;let i=Object.getPrototypeOf(o);for(;i&&i!==Object.prototype;)Object.getOwnPropertyNames(i).filter(t=>typeof(i==null?void 0:i[t])=="function").forEach(t=>r.add(t)),i=Object.getPrototypeOf(i);return Array.from(r)}function l(o){if(!o)return{};const r={};return Object.entries(o).forEach(([i,t])=>{switch(typeof t){case"number":case"bigint":case"boolean":r[String(i)]=t;break;case"string":t.length<50?r[String(i)]=t:r[String(i)]="set";break;case"object":i==="environment"?r.environment=t:i==="networkConfig"?r.networkConfig=t:r[String(i)]=t!=null?"set":"unset";break}}),r}}(be)),be}var Ge={},Rt;function un(){return Rt||(Rt=1,Object.defineProperty(Ge,"__esModule",{value:!0})),Ge}var Ve={},Ut;function cn(){return Ut||(Ut=1,Object.defineProperty(Ve,"__esModule",{value:!0})),Ve}var Je={},Mt;function dn(){return Mt||(Mt=1,Object.defineProperty(Je,"__esModule",{value:!0})),Je}var re={},Lt;function tn(){if(Lt)return re;Lt=1,Object.defineProperty(re,"__esModule",{value:!0}),re.createMemoKey=re.MemoPrefix=void 0,re.MemoPrefix={_gate:"g",_dynamicConfig:"c",_experiment:"e",_layer:"l",_paramStore:"p"};const e=new Set([]),y=new Set(["userPersistedValues"]);function u(f,v,_){let b=`${f}|${v}`;if(!_)return b;for(const p of Object.keys(_)){if(y.has(p))return;e.has(p)?b+=`|${p}=true`:b+=`|${p}=${_[p]}`}return b}return re.createMemoKey=u,re}var ie={},z={},oe={},Pt;function _n(){if(Pt)return oe;Pt=1;var e=oe&&oe.__awaiter||function(p,h,d,l){function o(r){return r instanceof d?r:new d(function(i){i(r)})}return new(d||(d=Promise))(function(r,i){function t(g){try{a(l.next(g))}catch(s){i(s)}}function n(g){try{a(l.throw(g))}catch(s){i(s)}}function a(g){g.done?r(g.value):o(g.value).then(t,n)}a((l=l.apply(p,h||[])).next())})};Object.defineProperty(oe,"__esModule",{value:!0}),oe._fetchTxtRecords=void 0;const y=new Uint8Array([0,0,1,0,0,1,0,0,0,0,0,0,13,102,101,97,116,117,114,101,97,115,115,101,116,115,3,111,114,103,0,0,16,0,1]),u="https://cloudflare-dns.com/dns-query",f=["i","e","d"],v=200;function _(p){return e(this,void 0,void 0,function*(){const h=yield p(u,{method:"POST",headers:{"Content-Type":"application/dns-message",Accept:"application/dns-message"},body:y});if(!h.ok){const o=new Error("Failed to fetch TXT records from DNS");throw o.name="DnsTxtFetchError",o}const d=yield h.arrayBuffer(),l=new Uint8Array(d);return b(l)})}oe._fetchTxtRecords=_;function b(p){const h=p.findIndex((l,o)=>o<v&&String.fromCharCode(l)==="="&&f.includes(String.fromCharCode(p[o-1])));if(h===-1){const l=new Error("Failed to parse TXT records from DNS");throw l.name="DnsTxtParseError",l}let d="";for(let l=h-1;l<p.length;l++)d+=String.fromCharCode(p[l]);return d.split(",")}return oe}var jt;function gn(){if(jt)return z;jt=1;var e=z&&z.__awaiter||function(i,t,n,a){function g(s){return s instanceof n?s:new n(function(E){E(s)})}return new(n||(n=Promise))(function(s,E){function w(D){try{m(a.next(D))}catch(O){E(O)}}function c(D){try{m(a.throw(D))}catch(O){E(O)}}function m(D){D.done?s(D.value):g(D.value).then(w,c)}m((a=a.apply(i,t||[])).next())})};Object.defineProperty(z,"__esModule",{value:!0}),z._isDomainFailure=z.NetworkFallbackResolver=void 0;const y=_n(),u=ge(),f=N(),v=Q(),_=7*24*60*60*1e3,b=4*60*60*1e3;let p=class{constructor(t){var n;this._fallbackInfo=null,this._errorBoundary=null,this._dnsQueryCooldowns={},this._networkOverrideFunc=(n=t.networkConfig)===null||n===void 0?void 0:n.networkOverrideFunc}setErrorBoundary(t){this._errorBoundary=t}tryBumpExpiryTime(t,n){var a;const g=(a=this._fallbackInfo)===null||a===void 0?void 0:a[n.endpoint];g&&(g.expiryTime=Date.now()+_,l(t,Object.assign(Object.assign({},this._fallbackInfo),{[n.endpoint]:g})))}getActiveFallbackUrl(t,n){var a,g;if(n.customUrl!=null&&n.fallbackUrls!=null)return null;let s=this._fallbackInfo;s==null&&(s=(a=o(t))!==null&&a!==void 0?a:{},this._fallbackInfo=s);const E=s[n.endpoint];return!E||Date.now()>((g=E.expiryTime)!==null&&g!==void 0?g:0)||n.getChecksum()!==E.urlConfigChecksum?(delete s[n.endpoint],this._fallbackInfo=s,l(t,this._fallbackInfo),null):E.url?E.url:null}tryFetchUpdatedFallbackInfo(t,n,a,g){var s,E;return e(this,void 0,void 0,function*(){try{if(!h(a,g))return!1;const c=n.customUrl==null&&n.fallbackUrls==null?yield this._tryFetchFallbackUrlsFromNetwork(n):n.fallbackUrls,m=this._pickNewFallbackUrl((s=this._fallbackInfo)===null||s===void 0?void 0:s[n.endpoint],c);return m?(this._updateFallbackInfoWithNewUrl(t,n,m),!0):!1}catch(w){return(E=this._errorBoundary)===null||E===void 0||E.logError("tryFetchUpdatedFallbackInfo",w),!1}})}_updateFallbackInfoWithNewUrl(t,n,a){var g,s,E;const w={urlConfigChecksum:n.getChecksum(),url:a,expiryTime:Date.now()+_,previous:[]},c=n.endpoint,m=(g=this._fallbackInfo)===null||g===void 0?void 0:g[c];m&&w.previous.push(...m.previous),w.previous.length>10&&(w.previous=[]);const D=(E=(s=this._fallbackInfo)===null||s===void 0?void 0:s[c])===null||E===void 0?void 0:E.url;D!=null&&w.previous.push(D),this._fallbackInfo=Object.assign(Object.assign({},this._fallbackInfo),{[c]:w}),l(t,this._fallbackInfo)}_tryFetchFallbackUrlsFromNetwork(t){var n;return e(this,void 0,void 0,function*(){const a=this._dnsQueryCooldowns[t.endpoint];if(a&&Date.now()<a)return null;this._dnsQueryCooldowns[t.endpoint]=Date.now()+b;const g=[],s=yield(0,y._fetchTxtRecords)((n=this._networkOverrideFunc)!==null&&n!==void 0?n:fetch),E=r(t.defaultUrl);for(const w of s){if(!w.startsWith(t.endpointDnsKey+"="))continue;const c=w.split("=");if(c.length>1){let m=c[1];m.endsWith("/")&&(m=m.slice(0,-1)),g.push(`https://${m}${E}`)}}return g})}_pickNewFallbackUrl(t,n){var a;if(n==null)return null;const g=new Set((a=t==null?void 0:t.previous)!==null&&a!==void 0?a:[]),s=t==null?void 0:t.url;let E=null;for(const w of n){const c=w.endsWith("/")?w.slice(0,-1):w;if(!g.has(w)&&c!==s){E=c;break}}return E}};z.NetworkFallbackResolver=p;function h(i,t){var n;const a=(n=i==null?void 0:i.toLowerCase())!==null&&n!==void 0?n:"";return t||a.includes("uncaught exception")||a.includes("failed to fetch")||a.includes("networkerror when attempting to fetch resource")}z._isDomainFailure=h;function d(i){return`statsig.network_fallback.${(0,u._DJB2)(i)}`}function l(i,t){const n=d(i);if(!t||Object.keys(t).length===0){v.Storage.removeItem(n);return}v.Storage.setItem(n,JSON.stringify(t))}function o(i){const t=d(i),n=v.Storage.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return f.Log.error("Failed to parse FallbackInfo"),null}}function r(i){try{return new URL(i).pathname}catch{return null}}return z}var Ee={},Nt;function nn(){if(Nt)return Ee;Nt=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.SDKFlags=void 0;const e={};return Ee.SDKFlags={setFlags:(y,u)=>{e[y]=u},get:(y,u)=>{var f,v;return(v=(f=e[y])===null||f===void 0?void 0:f[u])!==null&&v!==void 0?v:!1}},Ee}var ze={},At;function nt(){return At||(At=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StatsigSession=e.SessionID=void 0;const y=H(),u=Ie(),f=N(),v=Q(),_=et(),b=30*60*1e3,p=4*60*60*1e3,h={};e.SessionID={get:s=>e.StatsigSession.get(s).data.sessionID},e.StatsigSession={get:s=>{h[s]==null&&(h[s]=d(s));const E=h[s];return o(E)},overrideInitialSessionID:(s,E)=>{h[E]=l(s,E)}};function d(s){let E=g(s);const w=Date.now();return E||(E={sessionID:(0,_.getUUID)(),startTime:w,lastUpdate:w}),{data:E,sdkKey:s}}function l(s,E){const w=Date.now();return{data:{sessionID:s,startTime:w,lastUpdate:w},sdkKey:E}}function o(s){const E=Date.now(),w=s.data,c=s.sdkKey;if(i(w)||t(w)){w.sessionID=(0,_.getUUID)(),w.startTime=E;const D=__STATSIG__==null?void 0:__STATSIG__.instance(c);D&&D.$emt({name:"session_expired"})}w.lastUpdate=E,a(w,s.sdkKey),clearTimeout(s.idleTimeoutID),clearTimeout(s.ageTimeoutID);const m=E-w.startTime;return s.idleTimeoutID=r(c,b),s.ageTimeoutID=r(c,p-m),s}function r(s,E){return setTimeout(()=>{var w;const c=(w=(0,y._getStatsigGlobal)())===null||w===void 0?void 0:w.instance(s);c&&c.$emt({name:"session_expired"})},E)}function i({lastUpdate:s}){return Date.now()-s>b}function t({startTime:s}){return Date.now()-s>p}function n(s){return`statsig.session_id.${(0,u._getStorageKey)(s)}`}function a(s,E){const w=n(E);try{(0,v._setObjectInStorage)(w,s)}catch{f.Log.warn("Failed to save SessionID")}}function g(s){const E=n(s);return(0,v._getObjectFromStorage)(E)}}(ze)),ze}var we={},Ft;function rn(){return Ft||(Ft=1,Object.defineProperty(we,"__esModule",{value:!0}),we.ErrorTag=void 0,we.ErrorTag={NetworkError:"NetworkError"}),we}var qt;function fn(){if(qt)return ie;qt=1;var e=ie&&ie.__awaiter||function(I,S,k,C){function T(U){return U instanceof k?U:new k(function(P){P(U)})}return new(k||(k=Promise))(function(U,P){function fe(A){try{$(C.next(A))}catch(F){P(F)}}function V(A){try{$(C.throw(A))}catch(F){P(F)}}function $(A){A.done?U(A.value):T(A.value).then(fe,V)}$((C=C.apply(I,S||[])).next())})};Object.defineProperty(ie,"__esModule",{value:!0}),ie.NetworkCore=void 0,H();const y=H(),u=Xe(),f=N(),v=Ce(),_=gn(),b=nn(),p=tt(),h=le(),d=nt(),l=Re(),o=rn(),r=Oe(),i=Te(),t=Ze(),n=1e4,a=500,g=3e4,s=1e3,E=50,w=E/s,c=new Set([408,500,502,503,504,522,524,599]);let m=class{constructor(S,k){this._emitter=k,this._errorBoundary=null,this._timeout=n,this._netConfig={},this._options={},this._leakyBucket={},this._lastUsedInitUrl=null,S&&(this._options=S),this._options.networkConfig&&(this._netConfig=this._options.networkConfig),this._netConfig.networkTimeoutMs&&(this._timeout=this._netConfig.networkTimeoutMs),this._fallbackResolver=new _.NetworkFallbackResolver(this._options),this.setLogEventCompressionMode(this._getLogEventCompressionMode(S))}setLogEventCompressionMode(S){this._options.logEventCompressionMode=S}setErrorBoundary(S){this._errorBoundary=S,this._errorBoundary.wrap(this),this._errorBoundary.wrap(this._fallbackResolver),this._fallbackResolver.setErrorBoundary(S)}isBeaconSupported(){return typeof navigator<"u"&&typeof navigator.sendBeacon=="function"}getLastUsedInitUrlAndReset(){const S=this._lastUsedInitUrl;return this._lastUsedInitUrl=null,S}beacon(S){return e(this,void 0,void 0,function*(){if(!D(S))return!1;const k=this._getInternalRequestArgs("POST",S);yield this._tryToCompressBody(k);const C=yield this._getPopulatedURL(k),T=navigator;return T.sendBeacon.bind(T)(C,k.body)})}post(S){return e(this,void 0,void 0,function*(){const k=this._getInternalRequestArgs("POST",S);return this._tryEncodeBody(k),yield this._tryToCompressBody(k),this._sendRequest(k)})}get(S){const k=this._getInternalRequestArgs("GET",S);return this._sendRequest(k)}_sendRequest(S){var k,C,T,U;return e(this,void 0,void 0,function*(){if(!D(S)||this._netConfig.preventAllNetworkTraffic)return null;const{method:P,body:fe,retries:V,attempt:$}=S,A=S.urlConfig.endpoint;if(this._isRateLimited(A))return f.Log.warn(`Request to ${A} was blocked because you are making requests too frequently.`),null;const F=$??1,K=typeof AbortController<"u"?new AbortController:null,ue=setTimeout(()=>{K==null||K.abort(`Timeout of ${this._timeout}ms expired.`)},this._timeout),ve=yield this._getPopulatedURL(S);let G=null;const on=(0,t._isUnloading)();try{const ce={method:P,body:fe,headers:Object.assign({},S.headers),signal:K==null?void 0:K.signal,priority:S.priority,keepalive:on};W(S,F);const de=this._leakyBucket[A];if(de&&(de.lastRequestTime=Date.now(),this._leakyBucket[A]=de),G=yield((k=this._netConfig.networkOverrideFunc)!==null&&k!==void 0?k:fetch)(ve,ce),clearTimeout(ue),!G.ok){const ke=yield G.text().catch(()=>"No Text"),it=new Error(`NetworkError: ${ve} ${ke}`);throw it.name="NetworkError",it}const Ue=yield G.text();return x(S,G,F,Ue),this._fallbackResolver.tryBumpExpiryTime(S.sdkKey,S.urlConfig),{body:Ue,code:G.status}}catch(ce){const de=L(K,ce),rt=M(K);if(x(S,G,F,"",ce),(yield this._fallbackResolver.tryFetchUpdatedFallbackInfo(S.sdkKey,S.urlConfig,de,rt))&&(S.fallbackUrl=this._fallbackResolver.getActiveFallbackUrl(S.sdkKey,S.urlConfig)),!V||F>V||!c.has((C=G==null?void 0:G.status)!==null&&C!==void 0?C:500)){(T=this._emitter)===null||T===void 0||T.call(this,{name:"error",error:ce,tag:o.ErrorTag.NetworkError,requestArgs:S});const ke=`A networking error occurred during ${P} request to ${ve}.`;return f.Log.error(ke,de,ce),(U=this._errorBoundary)===null||U===void 0||U.attachErrorIfNoneExists(ke),null}return yield B(F),this._sendRequest(Object.assign(Object.assign({},S),{retries:V,attempt:F+1}))}})}_getLogEventCompressionMode(S){let k=S==null?void 0:S.logEventCompressionMode;return!k&&(S==null?void 0:S.disableCompression)===!0&&(k=i.LogEventCompressionMode.Disabled),k||(k=i.LogEventCompressionMode.Enabled),k}_isRateLimited(S){var k;const C=Date.now(),T=(k=this._leakyBucket[S])!==null&&k!==void 0?k:{count:0,lastRequestTime:C},U=C-T.lastRequestTime,P=Math.floor(U*w);return T.count=Math.max(0,T.count-P),T.count>=E?!0:(T.count+=1,T.lastRequestTime=C,this._leakyBucket[S]=T,!1)}_getPopulatedURL(S){var k;return e(this,void 0,void 0,function*(){const C=(k=S.fallbackUrl)!==null&&k!==void 0?k:S.urlConfig.getUrl();(S.urlConfig.endpoint===v.Endpoint._initialize||S.urlConfig.endpoint===v.Endpoint._download_config_specs)&&(this._lastUsedInitUrl=C);const T=Object.assign({[v.NetworkParam.SdkKey]:S.sdkKey,[v.NetworkParam.SdkType]:p.SDKType._get(S.sdkKey),[v.NetworkParam.SdkVersion]:r.SDK_VERSION,[v.NetworkParam.Time]:String(Date.now()),[v.NetworkParam.SessionID]:d.SessionID.get(S.sdkKey)},S.params),U=Object.keys(T).map(P=>`${encodeURIComponent(P)}=${encodeURIComponent(T[P])}`).join("&");return`${C}${U?`?${U}`:""}`})}_tryEncodeBody(S){var k;const C=(0,h._getWindowSafe)(),T=S.body;if(!(!S.isStatsigEncodable||this._options.disableStatsigEncoding||typeof T!="string"||(0,y._getStatsigGlobalFlag)("no-encode")!=null||!(C!=null&&C.btoa)))try{S.body=C.btoa(T).split("").reverse().join(""),S.params=Object.assign(Object.assign({},(k=S.params)!==null&&k!==void 0?k:{}),{[v.NetworkParam.StatsigEncoded]:"1"})}catch(U){f.Log.warn(`Request encoding failed for ${S.urlConfig.getUrl()}`,U)}}_tryToCompressBody(S){var k;return e(this,void 0,void 0,function*(){const C=S.body;if(!(typeof C!="string"||!R(S,this._options)))try{const T=new TextEncoder().encode(C),U=new CompressionStream("gzip"),P=U.writable.getWriter();P.write(T).catch(f.Log.error),P.close().catch(f.Log.error);const fe=U.readable.getReader(),V=[];let $;for(;!($=yield fe.read()).done;)V.push($.value);const A=V.reduce((ue,ve)=>ue+ve.length,0),F=new Uint8Array(A);let K=0;for(const ue of V)F.set(ue,K),K+=ue.length;S.body=F,S.params=Object.assign(Object.assign({},(k=S.params)!==null&&k!==void 0?k:{}),{[v.NetworkParam.IsGzipped]:"1"})}catch(T){f.Log.warn(`Request compression failed for ${S.urlConfig.getUrl()}`,T)}})}_getInternalRequestArgs(S,k){const C=this._fallbackResolver.getActiveFallbackUrl(k.sdkKey,k.urlConfig),T=Object.assign(Object.assign({},k),{method:S,fallbackUrl:C});return"data"in k&&O(T,k.data),T}};ie.NetworkCore=m;const D=I=>I.sdkKey?!0:(f.Log.warn("Unable to make request without an SDK key"),!1),O=(I,S)=>{const{sdkKey:k,fallbackUrl:C}=I,T=l.StableID.get(k),U=d.SessionID.get(k),P=p.SDKType._get(k);I.body=JSON.stringify(Object.assign(Object.assign({},S),{statsigMetadata:Object.assign(Object.assign({},r.StatsigMetadataProvider.get()),{stableID:T,sessionID:U,sdkType:P,fallbackUrl:C})}))};function R(I,S){if(!I.isCompressable||(0,y._getStatsigGlobalFlag)("no-compress")!=null||typeof CompressionStream>"u"||typeof TextEncoder>"u")return!1;const k=I.urlConfig.customUrl!=null||I.urlConfig.fallbackUrls!=null,C=b.SDKFlags.get(I.sdkKey,"enable_log_event_compression")===!0;switch(S.logEventCompressionMode){case i.LogEventCompressionMode.Disabled:return!1;case i.LogEventCompressionMode.Enabled:return!(k&&!C);case i.LogEventCompressionMode.Forced:return!0;default:return!1}}function L(I,S){return I!=null&&I.signal.aborted&&typeof I.signal.reason=="string"?I.signal.reason:typeof S=="string"?S:S instanceof Error?`${S.name}: ${S.message}`:"Unknown Error"}function M(I){return(I==null?void 0:I.signal.aborted)&&typeof I.signal.reason=="string"&&I.signal.reason.includes("Timeout")||!1}function W(I,S){I.urlConfig.endpoint===v.Endpoint._initialize&&u.Diagnostics._markInitNetworkReqStart(I.sdkKey,{attempt:S})}function x(I,S,k,C,T){I.urlConfig.endpoint===v.Endpoint._initialize&&u.Diagnostics._markInitNetworkReqEnd(I.sdkKey,u.Diagnostics._getDiagnosticsData(S,k,C,T))}function B(I){return e(this,void 0,void 0,function*(){yield new Promise(S=>setTimeout(S,Math.min(a*(I*I),g)))})}return ie}var We={},Kt;function vn(){return Kt||(Kt=1,Object.defineProperty(We,"__esModule",{value:!0})),We}var xe={},Bt;function hn(){return Bt||(Bt=1,Object.defineProperty(xe,"__esModule",{value:!0})),xe}var se={},$t;function yn(){if($t)return se;$t=1;var e=se&&se.__awaiter||function(t,n,a,g){function s(E){return E instanceof a?E:new a(function(w){w(E)})}return new(a||(a=Promise))(function(E,w){function c(O){try{D(g.next(O))}catch(R){w(R)}}function m(O){try{D(g.throw(O))}catch(R){w(R)}}function D(O){O.done?E(O.value):s(O.value).then(c,m)}D((g=g.apply(t,n||[])).next())})};Object.defineProperty(se,"__esModule",{value:!0}),se.StatsigClientBase=void 0,H();const y=H(),u=en(),f=Xt(),v=N(),_=tn(),b=le(),p=nt(),h=Re(),d=Te(),l=Q(),o=3e3;let r=class{constructor(n,a,g,s){var E,w,c,m;this.loadingStatus="Uninitialized",this._initializePromise=null,this._listeners={};const D=this.$emt.bind(this);(s==null?void 0:s.logLevel)!=null&&(v.Log.level=s.logLevel),s!=null&&s.disableStorage&&l.Storage._setDisabled(!0),s!=null&&s.initialSessionID&&p.StatsigSession.overrideInitialSessionID(s.initialSessionID,n),s!=null&&s.storageProvider&&l.Storage._setProvider(s.storageProvider),s!=null&&s.enableCookies&&h.StableID._setCookiesEnabled(n,s.enableCookies),s!=null&&s.disableStableID&&h.StableID._setDisabled(n,!0),this._sdkKey=n,this._options=s??{},this._memoCache={},this.overrideAdapter=(E=s==null?void 0:s.overrideAdapter)!==null&&E!==void 0?E:null,this._logger=new f.EventLogger(n,D,g,s),this._errorBoundary=new u.ErrorBoundary(n,s,D),this._errorBoundary.wrap(this),this._errorBoundary.wrap(a),this._errorBoundary.wrap(this._logger),g.setErrorBoundary(this._errorBoundary),this.dataAdapter=a,this.dataAdapter.attach(n,s,g),this.storageProvider=l.Storage,(m=(c=(w=this.overrideAdapter)===null||w===void 0?void 0:w.loadFromStorage)===null||c===void 0?void 0:c.call(w))===null||m===void 0||m.catch(O=>this._errorBoundary.logError("OA::loadFromStorage",O)),this._primeReadyRipcord(),i(n,this)}updateRuntimeOptions(n){n.loggingEnabled?(this._options.loggingEnabled=n.loggingEnabled,this._logger.setLoggingEnabled(n.loggingEnabled)):n.disableLogging!=null&&(this._options.disableLogging=n.disableLogging,this._logger.setLoggingEnabled(n.disableLogging?"disabled":"browser-only")),n.disableStorage!=null&&(this._options.disableStorage=n.disableStorage,l.Storage._setDisabled(n.disableStorage)),n.enableCookies!=null&&(this._options.enableCookies=n.enableCookies,h.StableID._setCookiesEnabled(this._sdkKey,n.enableCookies)),n.logEventCompressionMode?this._logger.setLogEventCompressionMode(n.logEventCompressionMode):n.disableCompression&&this._logger.setLogEventCompressionMode(d.LogEventCompressionMode.Disabled)}flush(){return this._logger.flush()}shutdown(){return e(this,void 0,void 0,function*(){this.$emt({name:"pre_shutdown"}),this._setStatus("Uninitialized",null),this._initializePromise=null,yield this._logger.stop()})}on(n,a){this._listeners[n]||(this._listeners[n]=[]),this._listeners[n].push(a)}off(n,a){if(this._listeners[n]){const g=this._listeners[n].indexOf(a);g!==-1&&this._listeners[n].splice(g,1)}}$on(n,a){a.__isInternal=!0,this.on(n,a)}$emt(n){var a;const g=s=>{try{s(n)}catch(E){if(s.__isInternal===!0){this._errorBoundary.logError(`__emit:${n.name}`,E);return}v.Log.error("An error occurred in a StatsigClientEvent listener. This is not an issue with Statsig.",n)}};this._listeners[n.name]&&this._listeners[n.name].forEach(s=>g(s)),(a=this._listeners["*"])===null||a===void 0||a.forEach(g)}_setStatus(n,a){this.loadingStatus=n,this._memoCache={},this.$emt({name:"values_updated",status:n,values:a})}_enqueueExposure(n,a,g){if((g==null?void 0:g.disableExposureLog)===!0){this._logger.incrementNonExposureCount(n);return}this._logger.enqueue(a)}_memoize(n,a){return(g,s)=>{if(this._options.disableEvaluationMemoization)return a(g,s);const E=(0,_.createMemoKey)(n,g,s);return E?(E in this._memoCache||(Object.keys(this._memoCache).length>=o&&(this._memoCache={}),this._memoCache[E]=a(g,s)),this._memoCache[E]):a(g,s)}}};se.StatsigClientBase=r;function i(t,n){var a;if((0,b._isServerEnv)())return;const g=(0,y._getStatsigGlobal)(),s=(a=g.instances)!==null&&a!==void 0?a:{},E=n;s[t]!=null&&v.Log.warn("Creating multiple Statsig clients with the same SDK key can lead to unexpected behavior. Multi-instance support requires different SDK keys."),s[t]=E,g.firstInstance||(g.firstInstance=E),g.instances=s,__STATSIG__=g}return se}var De={},Gt;function mn(){return Gt||(Gt=1,Object.defineProperty(De,"__esModule",{value:!0}),De.DataAdapterCachePrefix=void 0,De.DataAdapterCachePrefix="statsig.cached"),De}var He={},Vt;function Sn(){return Vt||(Vt=1,Object.defineProperty(He,"__esModule",{value:!0})),He}var j={},Jt;function bn(){if(Jt)return j;Jt=1,Object.defineProperty(j,"__esModule",{value:!0}),j._makeTypedGet=j._mergeOverride=j._makeLayer=j._makeExperiment=j._makeDynamicConfig=j._makeFeatureGate=void 0;const e=N(),y=Ye(),u="default";function f(l,o,r,i){var t;return{name:l,details:o,ruleID:(t=r==null?void 0:r.rule_id)!==null&&t!==void 0?t:u,__evaluation:r,value:i}}function v(l,o,r){return f(l,o,r,(r==null?void 0:r.value)===!0)}j._makeFeatureGate=v;function _(l,o,r){var i;const t=(i=r==null?void 0:r.value)!==null&&i!==void 0?i:{};return Object.assign(Object.assign({},f(l,o,r,t)),{get:d(l,r==null?void 0:r.value)})}j._makeDynamicConfig=_;function b(l,o,r){var i;const t=_(l,o,r);return Object.assign(Object.assign({},t),{groupName:(i=r==null?void 0:r.group_name)!==null&&i!==void 0?i:null})}j._makeExperiment=b;function p(l,o,r,i){var t,n;return Object.assign(Object.assign({},f(l,o,r,void 0)),{get:d(l,r==null?void 0:r.value,i),groupName:(t=r==null?void 0:r.group_name)!==null&&t!==void 0?t:null,__value:(n=r==null?void 0:r.value)!==null&&n!==void 0?n:{}})}j._makeLayer=p;function h(l,o,r,i){return Object.assign(Object.assign(Object.assign({},l),o),{get:d(l.name,r,i)})}j._mergeOverride=h;function d(l,o,r){return(i,t)=>{var n;const a=(n=o==null?void 0:o[i])!==null&&n!==void 0?n:null;return a==null?t??null:t!=null&&!(0,y._isTypeMatch)(a,t)?(e.Log.warn(`Parameter type mismatch. '${l}.${i}' was found to be type '${typeof a}' but fallback/return type is '${typeof t}'. See https://docs.statsig.com/client/javascript-sdk/#typed-getters`),t??null):(r==null||r(i),a)}}return j._makeTypedGet=d,j}var Qe={},zt;function pn(){return zt||(zt=1,Object.defineProperty(Qe,"__esModule",{value:!0})),Qe}var ae={},Wt;function En(){if(Wt)return ae;Wt=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.UPDATE_DETAIL_ERROR_MESSAGES=ae.createUpdateDetails=void 0;const e=(y,u,f,v,_,b)=>({duration:f,source:u,success:y,error:v,sourceUrl:_,warnings:b});return ae.createUpdateDetails=e,ae.UPDATE_DETAIL_ERROR_MESSAGES={NO_NETWORK_DATA:"No data was returned from the network. This may be due to a network timeout if a timeout value was specified in the options or ad blocker error."},ae}var xt;function wn(){return xt||(xt=1,function(e){var y=X&&X.__createBinding||(Object.create?function(d,l,o,r){r===void 0&&(r=o);var i=Object.getOwnPropertyDescriptor(l,o);(!i||("get"in i?!l.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return l[o]}}),Object.defineProperty(d,r,i)}:function(d,l,o,r){r===void 0&&(r=o),d[r]=l[o]}),u=X&&X.__exportStar||function(d,l){for(var o in d)o!=="default"&&!Object.prototype.hasOwnProperty.call(l,o)&&y(l,d,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.Storage=e.Log=e.EventLogger=e.Diagnostics=void 0,H();const f=H(),v=Xe();Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return v.Diagnostics}});const _=Xt();Object.defineProperty(e,"EventLogger",{enumerable:!0,get:function(){return _.EventLogger}});const b=N();Object.defineProperty(e,"Log",{enumerable:!0,get:function(){return b.Log}});const p=Oe(),h=Q();Object.defineProperty(e,"Storage",{enumerable:!0,get:function(){return h.Storage}}),u(H(),e),u(Ie(),e),u(sn(),e),u(an(),e),u(Xe(),e),u(ln(),e),u(en(),e),u(un(),e),u(cn(),e),u(ge(),e),u(dn(),e),u(N(),e),u(tn(),e),u(Ce(),e),u(fn(),e),u(vn(),e),u(hn(),e),u(le(),e),u(tt(),e),u(nt(),e),u(Re(),e),u(yn(),e),u(rn(),e),u(mn(),e),u(Ht(),e),u(Oe(),e),u(Te(),e),u(Sn(),e),u(bn(),e),u(pn(),e),u(Yt(),e),u(Q(),e),u(Zt(),e),u(Ye(),e),u(Qt(),e),u(et(),e),u(Ze(),e),u(En(),e),u(nn(),e),Object.assign((0,f._getStatsigGlobal)(),{Log:b.Log,SDK_VERSION:p.SDK_VERSION})}(X)),X}var Mn=wn();export{kn as a,ot as c,Dn as g,wn as r,Mn as s};
